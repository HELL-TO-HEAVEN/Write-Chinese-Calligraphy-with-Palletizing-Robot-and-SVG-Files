;  平滑數值  "Output" = ("Input" + "OldAvg" * "SmoothingVar-1") / "SmoothingVar".
;台達驅動器Reset All Parameter to 出廠設定值 P2-08=10
;台達驅動器狀態 Ex. P0-2=7 馬達轉速 rpm
;台達驅動器Reset All Parameter to 出廠設定值 P2-08=10

;台達驅動器設定(Torque Command Pin 18 +V) P1-01=3,  P1-46=10000,  P2-66=4;
;台達驅動器設定(Speed Command Pin 20 +V) P0-2=7, P1-01=2, P1-37=3.5, P1-46=10000, P2-04=1000, P2-06=0, P2-66=4, IX21=0, IX22=0; 


;變頻器設定 TDS-F8
;1.先按 PRGM 再以 DSPL 連按選取 1-01 設定項
;2. 以上下鍵▲▼選取 2-01 按 ENTER 改數字 1 (控制迴路端子)
;3. 以上下鍵▲▼選取 2-02 按 ENTER 改數字 1 (控制迴路端子輸入訊號AIN)
;4. 以上下鍵▲▼選取 4-03 按 ENTER 改數字 0 (電壓訊號0~10V)
;5. 以上下鍵▲▼選取 3-01 按 ENTER 改數字 02 (輸出電流)

;變頻器設定  TDS-V8
;1.先按 PRGM 再以 DSPL 連按選取 sn-01 設定項
;2. 以上下鍵▲▼選取 sn-04 按 ENTER 改數字 1 (控制迴路端子)
;3. 以上下鍵▲▼選取 sn-05 按 ENTER 改數字 1 (控制迴路端子)
;4. 以上下鍵▲▼選取 sn-11 按 ENTER 改數字 0 (電壓訊號0~10V)
;5. 以上下鍵▲▼選取 sn-34 按 ENTER 改數字 2 (輸出電流)

;Controller_Setting設定

;馬達皮帶輪54齒，砂輪主軸46齒，齒輪比0.852 設定如下：
;GRINDER_REDUCER_RATIO             砂輪馬達減速比
;0.852

;馬達相數看馬達實際標示 設定如下：
;MOTOR_POLE                        砂輪馬達相數   
;2

;輸出電流參考變頻器說明書第5頁，額定輸出電流 ( 5HP=17.5 ) 設定如下：
;INVERTER_CURRENT_10V     砂輪馬達變頻器10V對應輸出電流
;17.5


;The followings are I-Variables
I0=0
I1=2
I2=$3
I3=0
I4=0
I5=0
I6=2
I7=0
I8=2
I9=3
I10=1
I11=0
I12=4     ; enable 4 Axes 
I13=$850
I14=0
I15=1
I16=0
I18=$30     ; enable A226 #1 & #2 card, I18=$10==>#1, I18=$20==>#2, I18=$30==>#1+#2
I19=0
I20=0
I21=0
I22=0
I23=0
I24=0
I25=1
I26=0
I27=0
I28=0
I101=20
I102=100
I103=5000
I104=4
I105=$1
I106=1
I107=1000
I108=0
I109=$500     ; 台達 axis
I110=0
I111=0
I112=0
I113=1
I114=1
I115=0
I116=1
I117=0
I118=0
I119=1
I120=10000
I121=0
I122=200
I123=500
I124=0
I125=0
I126=$84C
I127=$844
I128=1
I129=0
I130=32767
I131=160000   ;FE=10Deg
I132=0
I133=10
I134=20000
I135=8388607
I150=0
I151=500
I152=500
I153=100
I154=2000
I155=0.01
I156=200
I157=100
I158=2
I159=0
I160=1
I161=$0
I180=4    ; 台達 axis
I181=11
I182=0
I183=2    ; axis  4M filter
I185=$0A35
I186=50
I201=20
I202=100
I203=5000
I204=8
I205=$1
I206=1
I207=1000
I208=0
I209=$501    ; 台達 axis
I210=0
I211=0
I212=0
I213=1
I214=1
I215=0
I216=1
I217=0
I218=0
I219=1
I220=10000
I221=0
I222=200
I223=500
I224=0
I225=0
I226=$84D
I227=$845
I228=1
I229=0
I230=32767
I231=320000   ;FE=10Deg
I232=0
I233=10
I234=20000
I235=8388607
I250=0
I251=500
I252=500
I253=100
I254=2000
I255=0.01
I256=200
I257=100
I258=2
I259=0
I260=1
I261=$0
I280=0     ; 台達 axis
I281=11
I282=0     
I283=2     ; axis  4M filter
I285=$0
I286=50
I301=20
I302=100
I303=5000
I304=4
I305=$1
I306=1
I307=1000
I308=0
I309=$501    ; 台達 axis
I310=0
I311=0
I312=0
I313=1
I314=1
I315=0
I316=1
I317=0
I318=0
I319=1
I320=10000
I321=0
I322=200
I323=500
I324=0
I325=0
I326=$84E
I327=$846
I328=1
I329=0
I330=32767
I331=320000   ;FE=20Deg
I332=0
I333=10
I334=20000
I335=8388607
I350=0
I351=500
I352=500
I353=100
I354=2000
I355=0.01
I356=200
I357=100
I358=2
I359=0
I360=1
I361=$0
I380=0       ; 台達 axis
I381=11
I382=0
I383=2       ; axis  4M filter
I385=$0
I386=50
I401=20
I402=100
I403=5000
I404=4
I405=$1
I406=1
I407=1000
I408=0
I409=$500     ; 台達 axis
I410=0
I411=0
I412=0
I413=1
I414=1
I415=0
I416=1
I417=0
I418=0
I419=1
I420=5000
I421=0
I422=100
I423=250
I424=0
I425=0
I426=$84F
I427=$847
I428=1
I429=0
I430=32767
I431=320000   ;FE=20Deg
I432=0
I433=10
I434=20000
I435=8388607
I450=0
I451=500
I452=500
I453=100
I454=2000
I455=0.01
I456=200
I457=100
I458=2
I459=0
I460=1
I461=$0
I480=4      ; 台達 axis
I481=11
I482=0
I483=2      ; axis  4M filter
I485=$0
I486=50

;
; SUGGEST M-DEFINITION FOR UTC800V 2.3x
;
M0->9E9,0,24,S      ; INTERRUPT COUNTER

; GENERAL PURPOSE INPUTS AND OUTPUTS

M1->22,0,1          ; MACHINE OUTPUT 1 (JDO-2)
M2->22,1,1          ; MACHINE OUTPUT 2 (JDO-3)
M3->22,2,1          ; MACHINE OUTPUT 3 (JDO-4)
M4->22,3,1          ; MACHINE OUTPUT 4 (JDO-5)
M5->22,4,1          ; MACHINE OUTPUT 5 (JDO-6)
M6->22,5,1          ; MACHINE OUTPUT 6 (JDO-7)
M7->22,6,1          ; MACHINE OUTPUT 7 (JDO-8)
M8->22,7,1          ; MACHINE OUTPUT 8 (JDO-9)
M9->22,0,8          ; MACHINE OUTPUT 1-8 TREATED AS BYTE

;Debounced input in address 32
;Debounce cycle is set by I19
M11->I:5B,0,1       ; MACHINE INPUT 1 (JDI1-2)
M12->I:5B,1,1       ; MACHINE INPUT 2 (JDI1-3)
M13->I:5B,2,1       ; MACHINE INPUT 3 (JDI1-4)
M14->I:5B,3,1       ; MACHINE INPUT 4 (JDI1-5)
M15->I:5B,4,1       ; MACHINE INPUT 5 (JDI1-6)
M16->I:5B,5,1       ; MACHINE INPUT 6 (JDI1-7)
M17->I:5B,6,1       ; MACHINE INPUT 7 (JDI1-8)
M18->I:5B,7,1       ; MACHINE INPUT 8 (JDI1-9)
M19->I:5B,0,8       ; MACHINE INPUT 1-8 TREATED AS BYTE
M21->I:B0,0,1       ; MACHINE INPUT 9 (JDI2-2)
M22->I:B0,1,1       ; MACHINE INPUT 10 (JDI2-3)
M23->I:B0,2,1       ; MACHINE INPUT 11 (JDI2-4)
M24->I:B0,3,1       ; MACHINE INPUT 12 (JDI2-5)
M25->I:B0,4,1       ; MACHINE INPUT 13 (JDI2-6)
M26->I:B0,5,1       ; MACHINE INPUT 14 (JDI2-7)
M27->I:B0,6,1       ; MACHINE INPUT 15 (JDI2-8)
M28->I:B0,7,1       ; MACHINE INPUT 16 (JDI2-9)
M29->I:B0,0,8       ; MACHINE INPUT 9-16 TREATED AS BYTE

;M11->32,0,1        ; MACHINE INPUT 1 (JDI1-2)
;M12->32,1,1        ; MACHINE INPUT 1 (JDI1-3)
;M13->32,2,1        ; MACHINE INPUT 1 (JDI1-4)
;M14->32,3,1        ; MACHINE INPUT 1 (JDI1-5)
;M15->32,4,1        ; MACHINE INPUT 1 (JDI1-6)
;M16->32,5,1        ; MACHINE INPUT 1 (JDI1-7)
;M17->32,6,1        ; MACHINE INPUT 1 (JDI1-8)
;M18->32,7,1        ; MACHINE INPUT 1 (JDI1-9)
;M19->32,0,8        ; MACHINE INPUT 1-8 TREATED AS BYTE
;M21->32,8,1        ; MACHINE INPUT 9 (JDI2-2)
;M22->32,9,1        ; MACHINE INPUT 10 (JDI2-3)
;M23->32,10,1       ; MACHINE INPUT 11 (JDI2-4)
;M24->32,11,1       ; MACHINE INPUT 12 (JDI2-5)
;M25->32,12,1       ; MACHINE INPUT 13 (JDI2-6)
;M26->32,13,1       ; MACHINE INPUT 14 (JDI2-7)
;M27->32,14,1       ; MACHINE INPUT 15 (JDI2-8)
;M28->32,15,1       ; MACHINE INPUT 16 (JDI2-9)
;M29->32,8,8        ; MACHINE INPUT 9-16 TREATED AS BYTE

M30->22,8,1         ; MACHINE OUTPUT 17 (JTHW2-4)
M31->22,9,1         ; MACHINE OUTPUT 18 (JTHW2-6)
M32->22,10,1        ; MACHINE OUTPUT 19 (JTHW2-8)
M33->22,11,1        ; MACHINE OUTPUT 20 (JTHW2-10)
M34->22,12,1        ; MACHINE OUTPUT 21 (JTHW2-12)
M35->22,13,1        ; MACHINE OUTPUT 22 (JTHW2-14)
M36->22,14,1        ; MACHINE OUTPUT 23 (JTHW2-16)
M37->22,15,1        ; MACHINE OUTPUT 24 (JTHW2-18)
M38->22,8,8         ; MACHINE OUTPUT 17-24 TREATED AS BYTE

M40->22,16,1        ; MACHINE OUTPUT 9 (JTHW1-4)
M41->22,17,1        ; MACHINE OUTPUT 10 (JTHW1-6)
M42->22,18,1        ; MACHINE OUTPUT 11 (JTHW1-8)
M43->22,19,1        ; MACHINE OUTPUT 12 (JTHW1-10)
M44->22,20,1        ; MACHINE OUTPUT 13 (JTHW1-12)
M45->22,21,1        ; MACHINE OUTPUT 14 (JTHW1-14)
M46->22,22,1        ; MACHINE OUTPUT 15 (JTHW1-16)
M47->22,23,1        ; MACHINE OUTPUT 16 (JTHW1-18)
M48->22,16,8        ; MACHINE OUTPUT 9-16 TREATED AS BYTE

M50->I:B0,16,1      ; MACHINE INPUT 17 (JTHW1-3)
M51->I:B0,17,1      ; MACHINE INPUT 18 (JTHW1-5)
M52->I:B0,18,1      ; MACHINE INPUT 19 (JTHW1-7)
M53->I:B0,19,1      ; MACHINE INPUT 20 (JTHW1-9)
M54->I:B0,20,1      ; MACHINE INPUT 21 (JTHW1-11)
M55->I:B0,21,1      ; MACHINE INPUT 22 (JTHW1-13)
M56->I:B0,22,1      ; MACHINE INPUT 23 (JTHW1-15)
M57->I:B0,23,1      ; MACHINE INPUT 24 (JTHW1-17)
M58->I:B0,16,8      ; MACHINE INPUT 17-24 TREATED AS BYTE

;M50->32,24,1       ; MACHINE INPUT 17 (JTHW1-3)
;M51->32,25,1       ; MACHINE INPUT 18 (JTHW1-5)
;M52->32,26,1       ; MACHINE INPUT 19 (JTHW1-7)
;M53->32,27,1       ; MACHINE INPUT 20 (JTHW1-9)
;M54->32,28,1       ; MACHINE INPUT 21 (JTHW1-11)
;M55->32,29,1       ; MACHINE INPUT 22 (JTHW1-13)
;M56->32,30,1       ; MACHINE INPUT 23 (JTHW1-15)
;M57->32,31,1       ; MACHINE INPUT 24 (JTHW1-17)
;M58->32,24,8       ; MACHINE INPUT 17-24 TREATED AS BYTE

M60->I:B0,8,1       ; MACHINE INPUT 25 (JTHW2-3)
M61->I:B0,9,1       ; MACHINE INPUT 26 (JTHW2-5)
M62->I:B0,10,1      ; MACHINE INPUT 27 (JTHW2-7)
M63->I:B0,11,1      ; MACHINE INPUT 28 (JTHW2-9)
M64->I:B0,12,1      ; MACHINE INPUT 29 (JTHW2-11)
M65->I:B0,13,1      ; MACHINE INPUT 30 (JTHW2-13)
M66->I:B0,14,1      ; MACHINE INPUT 31 (JTHW2-15)
M67->I:B0,15,1      ; MACHINE INPUT 32 (JTHW2-17)
M68->I:B0,8,8       ; MACHINE INPUT 25-32 TREATED AS BYTE

;M60->32,16,1       ; MACHINE INPUT 25 (JTHW2-3)
;M61->32,17,1       ; MACHINE INPUT 26 (JTHW2-5)
;M62->32,18,1       ; MACHINE INPUT 27 (JTHW2-7)
;M63->32,19,1       ; MACHINE INPUT 28 (JTHW2-9)
;M64->32,20,1       ; MACHINE INPUT 29 (JTHW2-11)
;M65->32,21,1       ; MACHINE INPUT 30 (JTHW2-13)
;M66->32,22,1       ; MACHINE INPUT 31 (JTHW2-15)
;M67->32,23,1       ; MACHINE INPUT 32 (JTHW2-17)
;M68->32,16,8       ; MACHINE INPUT 25-32 TREATED AS BYTE

;M60->1E,3,1        ; RESERVED MACHINE OUTPUT1 (INPOS LED)
;M61->1E,2,1        ; RESERVED MACHINE OUTPUT2 (B.REQ LED)
;M62->1E,1,1        ; RESERVED MACHINE OUTPUT3 (FLT LED)
;M63->1E,0,1        ; RESERVED MACHINE OUTPUT4 (LIM LED)

M71->9EB,S          ; TIMER1 COUNT
M72->9EC,S          ; TIMER2 COUNT
M73->9ED,S          ; TIMER3 COUNT
M74->9EE,S          ; TIMER4 COUNT
M75->9EF,S          ; TIMER5 COUNT
M76->9F0,S          ; TIMER6 COUNT
M77->9F1,S          ; TIMER7 COUNT
M78->9F2,S          ; TIMER8 COUNT

M80->1C,2,2	        ; PWM FREQUENCY (0:4K / 1:8K / 2:16K)
M81->A89,S	        ; PWM1 DUTY	(4K:-2048~2047 / 8K:-1024~1023 / 16K:-512~511)
M82->A8A,S	        ; PWM2 DUTY	(4K:-2048~2047 / 8K:-1024~1023 / 16K:-512~511)
M83->A8B,S	        ; PWM3 DUTY	(4K:-2048~2047 / 8K:-1024~1023 / 16K:-512~511)
M84->A8C,S	        ; PWM4 DUTY	(4K:-2048~2047 / 8K:-1024~1023 / 16K:-512~511)

M85->8BD,S          ; MASTER AVERAGE INPUT VELUE
M86->A36,S          ; HANDWHEEL VALUE (M962)
M87->1D,5,3         ; HANDWHEEL DECODE CONTROL (I980)(I40)
M88->1D,8,2         ; HANDWHEEL DECODE FILTER FREQUENCY (I983)(I41)

M90->22,28,1        ; MACHINE OUTPUT 25 (JTHW1-19)
M91->22,29,1        ; MACHINE OUTPUT 26 (JTHW1-21)
M92->22,30,1        ; MACHINE OUTPUT 27 (JTHW1-23)
M93->22,31,1        ; MACHINE OUTPUT 28 (JTHW1-26)
M94->22,24,1        ; MACHINE OUTPUT 29 (JTHW2-19)
M95->22,25,1        ; MACHINE OUTPUT 30 (JTHW2-21)
M96->22,26,1        ; MACHINE OUTPUT 31 (JTHW2-23)
M97->22,27,1        ; MACHINE OUTPUT 32 (JTHW2-26)
M98->22,24,8        ; MACHINE OUTPUT 25-32 TREATED AS BYTE

;Registers associated with axis1
M101->I:40,0,16,S   ; #1 16-BIT UPDOWN COUNTER (COUNTS)
M102->985,S         ; #1 OUTPUT_DAC vvvvv 800V OutDAC[i]=$985..98c
M103->I:60,0,16,S   ; #1 16-BIT CAPTURE REGISTER (COUNTS)
M104->9FC,S         ; #1 CAPTURED INDEX
;M105->I:69,0,16    ; ADC1 16-BIT ANALOG INPUT (FOR 0~5 V)
M105->2E,S          ; ADC1 16-BIT ANALOG INPUT (BUFFERED FOR +/-10 V)
M114->1C,8,1        ; #1 SERVO ON/OFF
M116->I:48,0,1      ; #1 ENCODER CAPTURED FLAG
M117->9,14,1        ; #1 POSITION CAPTURED FLAG (MUST CLEARED AFTER READ)
M120->I:59,2,1      ; HMFL1 INPUT STATUS
M121->I:59,1,1      ; -LIM1 INPUT STATUS
M122->I:59,0,1      ; +LIM1 INPUT STATUS
M123->I:59,3,1      ; FAULT1 INPUT STATUS
M124->I:59,2,1      ; HMFL1 INPUT STATUS
M131->9,0,1         ; #1 POSITIVE LIMIT SET
M132->9,1,1         ; #1 NEGATIVE LIMIT SET
M133->9B5,0,1       ; #1 ABORT FLAG
M139->9,7,1         ; #1 DRIVER ENABLE BIT
M140->9,3,1         ; #1 IN-POSITION BIT
M141->35,3,3        ; #1 JOG/JOGTO IN PROGRESS vvv
M142->F5,S          ; #1 HOME IN PROGRESS
M143->9,2,1         ; #1 DRIVER FAULT SET
M144->9,12,1        ; #1 FATAL FOLLOWING ERROR
M145->35,2,1        ; #1 HOME COMPLETE
M146->35,5,1        ; #1 JOGTO IN PROGRESS
M147->4FA,S         ; #1 INC MODE
M148->D5,S	        ; #1 JOG SEGMENT (4 MEANS ACC/DECEL COMPLETE)
M161->1cd,S         ; #1 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
M162->84C,S         ; #1 ACTUAL POSITION (COUNTS)	EncPos[x]
M163->L:3D          ; #1 JOG REGISTER POSITION (COUNTS) vvvvv 800V L:3d
M164->L:2AD         ; #1 POSITION BIAS (COUNTS)
M165->L:2E5         ; #1 COORDINATE TARGET POSITION (USER UNITS)
M166->L:2ED         ; #1 COORDINATE TARGET POSITION (COUNTS)
M167->844,S         ; #1 ACTUAL VELOCITY (UNIT: COUNTS/MSEC) EncVel[x]
M168->895,S         ; #1 PRESENT MASTER VELOCITY (COUNTS/MSEC)
M169->L:1E5         ; #1 COMMAND VELOCITY (UNIT: COUNTS/MSEC)
M170->96D,S         ; #1 FOLLOWING ERROR (UNIT: COUNTS)
M171->EA7E,S        ; #1 COMPENSATION CORRECTION VALUE (UNIT: COUNTS)
M172->88D,S         ; #1 PRESENT MASTER POSITION (UNIT: COUNTS)
M191->L:275         ; #1 AXIS SCALE
M192->1C5,0,8,S	    ; #1 AXIS DEFINITION
M193->1C5,8,4,S	    ; #1 DEFINED IN WHICH C.S.

;Registers associated with coordinate system 1
M180->574,S         ; &1 RUN REQUEST
M181->789,S         ; BUFFER OPENED
M182->78B,S         ; INS MODE
M183->5CC,S         ; &1 PROGRAM HOLD
M184->4EA,S         ; &1 PROGRAM NUMBER
M185->584,S         ; &1 RAPID MODE
M186->50A,S         ; &1 LINEAR MODE
M187->L:51A         ; &1 CIR MODE (-1:CIR1 / 1:CIR2)
M188->6DC,S         ; &1 CALL STACK POINTER
M189->1,0,1         ; &1 DWELL IN PROGRESS
M190->1,1,1         ; <RESERVED>
M195->1,2,1         ; &1 HOME IN PROGRESS
M197->L:24D         ; &1 COMMAND FEEDRATE OVERRIDE
M198->L:23D         ; &1 PRESENT FEEDRATE OVERRIDE

;Registers associated with axis2
M201->I:41,0,16,S   ; #2 16-BIT UPDOWN COUNTER (COUNTS)
M202->986,S         ; #2 OUTPUT_DAC vvvvv 800V OutDAC[i]=$985..98c
M203->I:61,0,16,S   ; #2 16-BIT CAPTURE REGISTER (COUNTS)
M204->9FD,S         ; #2 CAPTURED INDEX
;M205->I:6A,0,16    ; ADC2 16-BIT ANALOG INPUT (FOR 0~5 V)
M205->2F,S          ; ADC2 16-BIT ANALOG INPUT (BUFFERED FOR +/-10 V)
M214->1C,9,1        ; #2 SERVO ON/OFF
M216->I:49,0,1      ; #2 ENCODER CAPTURED FLAG
M217->A,14,1        ; #2 POSITION CAPTURED FLAG (MUST CLEARED AFTER READ)
M220->I:59,6,1      ; HMFL2 INPUT STATUS
M221->I:59,5,1      ; -LIM2 INPUT STATUS
M222->I:59,4,1      ; +LIM2 INPUT STATUS
M223->I:59,7,1      ; FAULT2 INPUT STATUS
M224->I:59,6,1      ; HMFL2 INPUT STATUS
M231->A,0,1         ; #2 POSITIVE LIMIT SET
M232->A,1,1         ; #2 NEGATIVE LIMIT SET
M233->9B5,1,1       ; #2 ABORT FLAG
M239->A,7,1         ; #2 DRIVER ENABLE BIT
M240->A,3,1         ; #2 IN-POSITION BIT
M241->36,3,3        ; #2 JOG/JOGTO IN PROGRESS vvv
M242->F6,S          ; #2 HOME IN PROGRESS
M243->A,2,1         ; #2 DRIVER FAULT SET
M244->A,12,1        ; #2 FATAL FOLLOWING ERROR
M245->36,2,1        ; #2 HOME COMPLETE
M246->36,5,1        ; #2 JOGTO IN PROGRESS
M247->4FB,S         ; #2 INC MODE
M248->D6,S	    ; #2 JOG SEGMENT (4 MEANS ACC/DECEL COMPLETE)
M261->1ce,S         ; #2 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
M262->84D,S         ; #2 ACTUAL POSITION (COUNTS)	EncPos[x]
M263->L:3E          ; #2 JOG REGISTER POSITION (COUNTS) vvvvv 800V L:3e
M264->L:2AE         ; #2 POSITION BIAS (COUNTS)
M265->L:2E6         ; #2 COORDINATE TARGET POSITION (USER UNITS)
M266->L:2EE         ; #2 COORDINATE TARGET POSITION (COUNTS)
M267->845,S         ; #2 ACTUAL VELOCITY (UNIT: COUNTS/MSEC) EncVel[x]
M268->896,S         ; #2 PRESENT MASTER VELOCITY (COUNTS/MSEC)
M269->L:1E6         ; #2 COMMAND VELOCITY (UNIT: COUNTS/MSEC)
M270->96E,S         ; #2 FOLLOWING ERROR (UNIT: COUNTS)
M271->EA7F,S        ; #2 COMPENSATION CORRECTION VALUE (UNIT: COUNTS)
M272->88E,S         ; #2 PRESENT MASTER POSITION (UNIT: COUNTS)
M291->L:276         ; #2 AXIS SCALE
M292->1C6,0,8,S	    ; #2 AXIS DEFINITION
M293->1C6,8,4,S	    ; #2 DEFINED IN WHICH C.S.

;Registers associated with coordinate system 2
M280->575,S         ; &2 RUN REQUEST
M283->5CD,S         ; &2 PROGRAM HOLD
M284->4EB,S         ; &2 PROGRAM NUMBER
M285->585,S         ; &2 RAPID MODE
M286->50B,S         ; &2 LINEAR MODE
M287->L:51B         ; &2 CIR MODE (-1:CIR1 / 1:CIR2)
M288->6DD,S         ; &2 CALL STACK POINTER
M289->2,0,1         ; &2 DWELL IN PROGRESS
M290->2,1,1         ; <RESERVED>
M295->2,2,1         ; &2 HOME IN PROGRESS
M297->L:24E         ; &2 COMMAND FEEDRATE OVERRIDE
M298->L:23E         ; &2 PRESENT FEEDRATE OVERRIDE

;Registers associated with axis3
M301->I:42,0,16,S   ; #3 16-BIT UPDOWN COUNTER (COUNTS)
M302->987,S         ; #3 OUTPUT_DAC vvvvv 800V OutDAC[i]=$985..98c
M303->I:62,0,16,S   ; #3 16-BIT CAPTURE REGISTER (COUNTS)
M304->9FE,S         ; #3 CAPTURED INDEX
;M305->I:6B,0,16    ; ADC3 16-BIT ANALOG INPUT (FOR 0~5 V)
M305->30,S          ; ADC3 16-BIT ANALOG INPUT (BUFFERED FOR +/-10 V)
M314->1C,10,1       ; #3 SERVO ON/OFF
M316->I:4A,0,1      ; #3 ENCODER CAPTURED FLAG
M317->B,14,1        ; #3 POSITION CAPTURED FLAG (MUST CLEARED AFTER READ)
M320->I:59,10,1     ; HMFL3 INPUT STATUS
M321->I:59,9,1      ; -LIM3 INPUT STATUS
M322->I:59,8,1      ; +LIM3 INPUT STATUS
M323->I:59,11,1     ; FAULT3 INPUT STATUS
M324->I:59,10,1     ; HMFL3 INPUT STATUS
M331->B,0,1         ; #3 POSITIVE LIMIT SET
M332->B,1,1         ; #3 NEGATIVE LIMIT SET
M333->9B5,2,1       ; #3 ABORT FLAG vvvvv (not 9B7 error)
M339->B,7,1         ; #3 DRIVER ENABLE BIT
M340->B,3,1         ; #3 IN-POSITION BIT
M341->37,3,3        ; #3 JOG/JOGTO IN PROGRESS vvv
M342->F7,S          ; #3 HOME IN PROGRESS
M343->B,2,1         ; #3 DRIVER FAULT SET
M344->B,12,1        ; #3 FATAL FOLLOWING ERROR
M345->37,2,1        ; #3 HOME COMPLETE
M346->37,5,1        ; #3 JOGTO IN PROGRESS
M347->4FC,S         ; #3 INC MODE
M348->D7,S	    ; #3 JOG SEGMENT (4 MEANS ACC/DECEL COMPLETE)
M361->1cf,S         ; #3 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
M362->84E,S         ; #3 ACTUAL POSITION (COUNTS)	EncPos[x]
M363->L:3F          ; #3 JOG REGISTER POSITION (COUNTS) vvvvv 800V L:3f
M364->L:2AF         ; #3 POSITION BIAS (COUNTS)
M365->L:2E7         ; #3 COORDINATE TARGET POSITION (USER UNITS)
M366->L:2EF         ; #3 COORDINATE TARGET POSITION (COUNTS)
M367->846,S         ; #3 ACTUAL VELOCITY (UNIT: COUNTS/MSEC) EncVel[x]
M368->897,S         ; #3 PRESENT MASTER VELOCITY (COUNTS/MSEC)
M369->L:1E7         ; #3 COMMAND VELOCITY (UNIT: COUNTS/MSEC)
M370->96F,S         ; #3 FOLLOWING ERROR (UNIT: COUNTS)
M371->EA80,S        ; #3 COMPENSATION CORRECTION VALUE (UNIT: COUNTS)
M372->88F,S         ; #3 PRESENT MASTER POSITION (UNIT: COUNTS)
M391->L:277         ; #3 AXIS SCALE
M392->1C7,0,8,S	    ; #3 AXIS DEFINITION
M393->1C7,8,4,S	    ; #3 DEFINED IN WHICH C.S.

;Registers associated with coordinate system 3
M380->576,S         ; &3 RUN REQUEST
M383->5CE,S         ; &3 PROGRAM HOLD
M384->4EC,S         ; &3 PROGRAM NUMBER
M385->586,S         ; &3 RAPID MODE
M386->50C,S         ; &3 LINEAR MODE
M387->L:51C         ; &3 CIR MODE (-1:CIR1 / 1:CIR2)
M388->6DE,S         ; &3 CALL STACK POINTER
M389->3,0,1         ; &3 DWELL IN PROGRESS
M390->3,1,1         ; <RESERVED>
M395->3,2,1         ; &3 HOME IN PROGRESS
M397->L:24F         ; &3 COMMAND FEEDRATE OVERRIDE
M398->L:23F         ; &3 PRESENT FEEDRATE OVERRIDE

;Registers associated with axis4
M401->I:43,0,16,S   ; #4 16-BIT UPDOWN COUNTER (COUNTS)
M402->988,S         ; #4 OUTPUT_DAC vvvvv 800V OutDAC[i]=$985..98c
M403->I:63,0,16,S   ; #4 16-BIT CAPTURE REGISTER (COUNTS)
M404->9FF,S         ; #4 CAPTURED INDEX
;M405->I:6C,0,16    ; ADC4 16-BIT ANALOG INPUT (FOR 0~5 V)
M405->31,S          ; ADC4 16-BIT ANALOG INPUT (BUFFERED FOR +/-10 V)
M414->1C,11,1       ; #4 SERVO ON/OFF
M416->I:4B,0,1      ; #4 ENCODER CAPTURED FLAG
M417->C,14,1        ; #4 POSITION CAPTURED FLAG (MUST CLEARED AFTER READ)
M420->I:59,14,1     ; HMFL4 INPUT STATUS
M421->I:59,13,1     ; -LIM4 INPUT STATUS
M422->I:59,12,1     ; +LIM4 INPUT STATUS
M423->I:59,15,1     ; FAULT4 INPUT STATUS
M424->I:59,14,1     ; HMFL4 INPUT STATUS
M431->C,0,1         ; #4 POSITIVE LIMIT SET
M432->C,1,1         ; #4 NEGATIVE LIMIT SET
M433->9B5,3,1       ; #4 ABORT FLAG vvvvv(not 9B8 error)
M439->C,7,1         ; #4 DRIVER ENABLE BIT
M440->C,3,1         ; #4 IN-POSITION BIT
M441->38,3,3        ; #4 JOG/JOGTO IN PROGRESS vvv
M442->F8,S          ; #4 HOME IN PROGRESS
M443->C,2,1         ; #4 DRIVER FAULT SET
M444->C,12,1        ; #4 FATAL FOLLOWING ERROR
M445->38,2,1        ; #4 HOME COMPLETE
M446->38,5,1        ; #4 JOGTO IN PROGRESS
M447->4FD,S         ; #4 INC MODE
M448->D8,S	    ; #4 JOG SEGMENT (4 MEANS ACC/DECEL COMPLETE)
M461->1d0,S         ; #4 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
M462->84F,S         ; #4 ACTUAL POSITION (COUNTS)	EncPos[x]
M463->L:40          ; #4 JOG REGISTER POSITION (COUNTS) vvvvv 800V L:40
M464->L:2B0         ; #4 POSITION BIAS (COUNTS)
M465->L:2E8         ; #4 COORDINATE TARGET POSITION (USER UNITS)
M466->L:2F0         ; #4 COORDINATE TARGET POSITION (COUNTS)
M467->847,S         ; #4 ACTUAL VELOCITY (UNIT: COUNTS/MSEC) EncVel[x]
M468->898,S         ; #4 PRESENT MASTER VELOCITY (COUNTS/MSEC)
M469->L:1E8         ; #4 COMMAND VELOCITY (UNIT: COUNTS/MSEC)
M470->970,S         ; #4 FOLLOWING ERROR (UNIT: COUNTS)
M471->EA81,S        ; #4 COMPENSATION CORRECTION VALUE (UNIT: COUNTS)
M472->890,S         ; #4 PRESENT MASTER POSITION (UNIT: COUNTS)
M491->L:278         ; #4 AXIS SCALE
M492->1C8,0,8,S	    ; #4 AXIS DEFINITION
M493->1C8,8,4,S	    ; #4 DEFINED IN WHICH C.S.

;Registers associated with coordinate system 4
M480->577,S         ; &4 RUN REQUEST
M483->5CF,S         ; &4 PROGRAM HOLD
M484->4ED,S         ; &4 PROGRAM NUMBER
M485->587,S         ; &4 RAPID MODE
M486->50D,S         ; &4 LINEAR MODE
M487->L:51D         ; &4 CIR MODE (-1:CIR1 / 1:CIR2)
M488->6DF,S         ; &4 CALL STACK POINTER
M489->4,0,1         ; &4 DWELL IN PROGRESS
M490->4,1,1         ; <RESERVED>
M495->4,2,1         ; &4 HOME IN PROGRESS
M497->L:250         ; &4 COMMAND FEEDRATE OVERRIDE
M498->L:240         ; &4 PRESENT FEEDRATE OVERRIDE
M750->767,5,1       ;Complier PLC 5 ENA/DIS status

M714->1C,14,1       ; #7 SERVO ON/OFF
M814->1C,15,1       ; #8 SERVO ON/OFF
M833->9B5           ; ABORT FLAG vvvvv(not 9B8 error) FOR ALL COORDINATE(GLOBAL VARAIABLE)

;
;DEFINITION OF FIRST MT0226
M900->2A,0,1		; IN1
M901->2A,1,1		; IN2
M902->2A,2,1		; IN3
M903->2A,3,1		; IN4
M904->2A,4,1		; IN5
M905->2A,5,1		; IN6
M906->2A,6,1		; IN7
M907->2A,7,1		; IN8
M908->2A,8,1		; IN9
M909->2A,9,1		; IN10
M910->2A,10,1		; IN11
M911->2A,11,1		; IN12
M912->2A,12,1		; IN13
M913->2A,13,1		; IN14
M914->2A,14,1		; IN15
M915->2A,15,1		; IN16
M916->28,0,1		; OUT1
M917->28,1,1		; OUT2
M918->28,2,1		; OUT3
M919->28,3,1		; OUT4
M920->28,4,1		; OUT5
M921->28,5,1		; OUT6
M922->28,6,1		; OUT7
M923->28,7,1		; OUT8
M924->28,8,1		; OUT9
M925->28,9,1		; OUT10
M926->28,10,1		; OUT11
M927->28,11,1		; OUT12
M928->28,12,1		; OUT13
M929->28,13,1		; OUT14
M930->28,14,1		; OUT15
M931->28,15,1		; OUT16

;DEFINITION OF SECOND MT0226
M950->2A,16,1		; IN1
M951->2A,17,1		; IN2
M952->2A,18,1		; IN3
M953->2A,19,1		; IN4
M954->2A,20,1		; IN5
M955->2A,21,1		; IN6
M956->2A,22,1		; IN7
M957->2A,23,1		; IN8
M958->2A,24,1		; IN9
M959->2A,25,1		; IN10
M960->2A,26,1		; IN11
M961->2A,27,1		; IN12
M962->2A,28,1		; IN13
M963->2A,29,1		; IN14
M964->2A,30,1		; IN15
M965->2A,31,1		; IN16
M966->28,16,1		; OUT1
M967->28,17,1		; OUT2
M968->28,18,1		; OUT3
M969->28,19,1		; OUT4
M970->28,20,1		; OUT5
M971->28,21,1		; OUT6
M972->28,22,1		; OUT7
M973->28,23,1		; OUT8
M974->28,24,1		; OUT9
M975->28,25,1		; OUT10
M976->28,26,1		; OUT11
M977->28,27,1		; OUT12
M978->28,28,1		; OUT13
M979->28,29,1		; OUT14
M980->28,30,1		; OUT15
M981->28,31,1		; OUT16

;DEFINITION OF THIRD MT0226
M1000->2B,0,1		; IN1
M1001->2B,1,1		; IN2
M1002->2B,2,1		; IN3
M1003->2B,3,1		; IN4
M1004->2B,4,1		; IN5
M1005->2B,5,1		; IN6
M1006->2B,6,1		; IN7
M1007->2B,7,1		; IN8
M1008->2B,8,1		; IN9
M1009->2B,9,1		; IN10
M1010->2B,10,1		; IN11
M1011->2B,11,1		; IN12
M1012->2B,12,1		; IN13
M1013->2B,13,1		; IN14
M1014->2B,14,1		; IN15
M1015->2B,15,1		; IN16
M1016->29,0,1		; OUT1
M1017->29,1,1		; OUT2
M1018->29,2,1		; OUT3
M1019->29,3,1		; OUT4
M1020->29,4,1		; OUT5
M1021->29,5,1		; OUT6
M1022->29,6,1		; OUT7
M1023->29,7,1		; OUT8
M1024->29,8,1		; OUT9
M1025->29,9,1		; OUT10
M1026->29,10,1		; OUT11
M1027->29,11,1		; OUT12
M1028->29,12,1		; OUT13
M1029->29,13,1		; OUT14
M1030->29,14,1		; OUT15
M1031->29,15,1		; OUT16

;DEFINITION OF FORTH MT0226
M1050->2B,16,1		; IN1
M1051->2B,17,1		; IN2
M1052->2B,18,1		; IN3
M1053->2B,19,1		; IN4
M1054->2B,20,1		; IN5
M1055->2B,21,1		; IN6
M1056->2B,22,1		; IN7
M1057->2B,23,1		; IN8
M1058->2B,24,1		; IN9
M1059->2B,25,1		; IN10
M1060->2B,26,1		; IN11
M1061->2B,27,1		; IN12
M1062->2B,28,1		; IN13
M1063->2B,29,1		; IN14
M1064->2B,30,1		; IN15
M1065->2B,31,1		; IN16
M1066->29,16,1		; OUT1
M1067->29,17,1		; OUT2
M1068->29,18,1		; OUT3
M1069->29,19,1		; OUT4
M1070->29,20,1		; OUT5
M1071->29,21,1		; OUT6
M1072->29,22,1		; OUT7
M1073->29,23,1		; OUT8
M1074->29,24,1		; OUT9
M1075->29,25,1		; OUT10
M1076->29,26,1		; OUT11
M1077->29,27,1		; OUT12
M1078->29,28,1		; OUT13
M1079->29,29,1		; OUT14
M1080->29,30,1		; OUT15
M1081->29,31,1		; OUT16

;Registers associated with #1 captured data
M1099->A04          ; #1 CAPTURE BUFFER SIZE MASK 
M1100->E720,S       ; #1 CAPTURED POSITION 1
M1101->E721,S       ; #1 CAPTURED POSITION 2
M1102->E722,S       ; #1 CAPTURED POSITION 3
M1103->E723,S       ; #1 CAPTURED POSITION 4
M1104->E724,S       ; #1 CAPTURED POSITION 5
M1105->E725,S       ; #1 CAPTURED POSITION 6
M1106->E726,S       ; #1 CAPTURED POSITION 7
M1107->E727,S       ; #1 CAPTURED POSITION 8
M1108->E728,S       ; #1 CAPTURED POSITION 9
M1109->E729,S       ; #1 CAPTURED POSITION 10
M1110->E72A,S       ; #1 CAPTURED POSITION 11
M1111->E72B,S       ; #1 CAPTURED POSITION 12
M1112->E72C,S       ; #1 CAPTURED POSITION 13
M1113->E72D,S       ; #1 CAPTURED POSITION 14
M1114->E72E,S       ; #1 CAPTURED POSITION 15
M1115->E72F,S       ; #1 CAPTURED POSITION 16
M1116->E730,S       ; #1 CAPTURED POSITION 17
M1117->E731,S       ; #1 CAPTURED POSITION 18
M1118->E732,S       ; #1 CAPTURED POSITION 19
M1119->E733,S       ; #1 CAPTURED POSITION 20
M1120->E734,S       ; #1 CAPTURED POSITION 21
M1121->E735,S       ; #1 CAPTURED POSITION 22
M1122->E736,S       ; #1 CAPTURED POSITION 23
M1123->E737,S       ; #1 CAPTURED POSITION 24
M1124->E738,S       ; #1 CAPTURED POSITION 25
M1125->E739,S       ; #1 CAPTURED POSITION 26
M1126->E73A,S       ; #1 CAPTURED POSITION 27
M1127->E73B,S       ; #1 CAPTURED POSITION 28
M1128->E73C,S       ; #1 CAPTURED POSITION 29
M1129->E73D,S       ; #1 CAPTURED POSITION 30
M1130->E73E,S       ; #1 CAPTURED POSITION 31
M1131->E73F,S       ; #1 CAPTURED POSITION 32

;Registers associated with #2 captured data
M1199->A05          ; #2 CAPTURE BUFFER SIZE MASK 
M1200->E740,S       ; #2 CAPTURED POSITION 1
M1201->E741,S       ; #2 CAPTURED POSITION 2
M1202->E742,S       ; #2 CAPTURED POSITION 3
M1203->E743,S       ; #2 CAPTURED POSITION 4
M1204->E744,S       ; #2 CAPTURED POSITION 5
M1205->E745,S       ; #2 CAPTURED POSITION 6
M1206->E746,S       ; #2 CAPTURED POSITION 7
M1207->E747,S       ; #2 CAPTURED POSITION 8
M1208->E748,S       ; #2 CAPTURED POSITION 9
M1209->E749,S       ; #2 CAPTURED POSITION 10
M1210->E74A,S       ; #2 CAPTURED POSITION 11
M1211->E74B,S       ; #2 CAPTURED POSITION 12
M1212->E74C,S       ; #2 CAPTURED POSITION 13
M1213->E74D,S       ; #2 CAPTURED POSITION 14
M1214->E74E,S       ; #2 CAPTURED POSITION 15
M1215->E74F,S       ; #2 CAPTURED POSITION 16
M1216->E750,S       ; #2 CAPTURED POSITION 17
M1217->E751,S       ; #2 CAPTURED POSITION 18
M1218->E752,S       ; #2 CAPTURED POSITION 19
M1219->E753,S       ; #2 CAPTURED POSITION 20
M1220->E754,S       ; #2 CAPTURED POSITION 21
M1221->E755,S       ; #2 CAPTURED POSITION 22
M1222->E756,S       ; #2 CAPTURED POSITION 23
M1223->E757,S       ; #2 CAPTURED POSITION 24
M1224->E758,S       ; #2 CAPTURED POSITION 25
M1225->E759,S       ; #2 CAPTURED POSITION 26
M1226->E75A,S       ; #2 CAPTURED POSITION 27
M1227->E75B,S       ; #2 CAPTURED POSITION 28
M1228->E75C,S       ; #2 CAPTURED POSITION 29
M1229->E75D,S       ; #2 CAPTURED POSITION 30
M1230->E75E,S       ; #2 CAPTURED POSITION 31
M1231->E75F,S       ; #2 CAPTURED POSITION 32

;Registers associated with #3 captured data
M1299->A06          ; #3 CAPTURE BUFFER SIZE MASK 
M1300->E760,S       ; #3 CAPTURED POSITION 1
M1301->E761,S       ; #3 CAPTURED POSITION 2
M1302->E762,S       ; #3 CAPTURED POSITION 3
M1303->E763,S       ; #3 CAPTURED POSITION 4
M1304->E764,S       ; #3 CAPTURED POSITION 5
M1305->E765,S       ; #3 CAPTURED POSITION 6
M1306->E766,S       ; #3 CAPTURED POSITION 7
M1307->E767,S       ; #3 CAPTURED POSITION 8
M1308->E768,S       ; #3 CAPTURED POSITION 9
M1309->E769,S       ; #3 CAPTURED POSITION 10
M1310->E76A,S       ; #3 CAPTURED POSITION 11
M1311->E76B,S       ; #3 CAPTURED POSITION 12
M1312->E76C,S       ; #3 CAPTURED POSITION 13
M1313->E76D,S       ; #3 CAPTURED POSITION 14
M1314->E76E,S       ; #3 CAPTURED POSITION 15
M1315->E76F,S       ; #3 CAPTURED POSITION 16
M1316->E770,S       ; #3 CAPTURED POSITION 17
M1317->E771,S       ; #3 CAPTURED POSITION 18
M1318->E772,S       ; #3 CAPTURED POSITION 19
M1319->E773,S       ; #3 CAPTURED POSITION 20
M1320->E774,S       ; #3 CAPTURED POSITION 21
M1321->E775,S       ; #3 CAPTURED POSITION 22
M1322->E776,S       ; #3 CAPTURED POSITION 23
M1323->E777,S       ; #3 CAPTURED POSITION 24
M1324->E778,S       ; #3 CAPTURED POSITION 25
M1325->E779,S       ; #3 CAPTURED POSITION 26
M1326->E77A,S       ; #3 CAPTURED POSITION 27
M1327->E77B,S       ; #3 CAPTURED POSITION 28
M1328->E77C,S       ; #3 CAPTURED POSITION 29
M1329->E77D,S       ; #3 CAPTURED POSITION 30
M1330->E77E,S       ; #3 CAPTURED POSITION 31
M1331->E77F,S       ; #3 CAPTURED POSITION 32

;Registers associated with #4 captured data
M1399->A07          ; #4 CAPTURE BUFFER SIZE MASK 
M1400->E780,S       ; #4 CAPTURED POSITION 1
M1401->E781,S       ; #4 CAPTURED POSITION 2
M1402->E782,S       ; #4 CAPTURED POSITION 3
M1403->E783,S       ; #4 CAPTURED POSITION 4
M1404->E784,S       ; #4 CAPTURED POSITION 5
M1405->E785,S       ; #4 CAPTURED POSITION 6
M1406->E786,S       ; #4 CAPTURED POSITION 7
M1407->E787,S       ; #4 CAPTURED POSITION 8
M1408->E788,S       ; #4 CAPTURED POSITION 9
M1409->E789,S       ; #4 CAPTURED POSITION 10
M1410->E78A,S       ; #4 CAPTURED POSITION 11
M1411->E78B,S       ; #4 CAPTURED POSITION 12
M1412->E78C,S       ; #4 CAPTURED POSITION 13
M1413->E78D,S       ; #4 CAPTURED POSITION 14
M1414->E78E,S       ; #4 CAPTURED POSITION 15
M1415->E78F,S       ; #4 CAPTURED POSITION 16
M1416->E790,S       ; #4 CAPTURED POSITION 17
M1417->E791,S       ; #4 CAPTURED POSITION 18
M1418->E792,S       ; #4 CAPTURED POSITION 19
M1419->E793,S       ; #4 CAPTURED POSITION 20
M1420->E794,S       ; #4 CAPTURED POSITION 21
M1421->E795,S       ; #4 CAPTURED POSITION 22
M1422->E796,S       ; #4 CAPTURED POSITION 23
M1423->E797,S       ; #4 CAPTURED POSITION 24
M1424->E798,S       ; #4 CAPTURED POSITION 25
M1425->E799,S       ; #4 CAPTURED POSITION 26
M1426->E79A,S       ; #4 CAPTURED POSITION 27
M1427->E79B,S       ; #4 CAPTURED POSITION 28
M1428->E79C,S       ; #4 CAPTURED POSITION 29
M1429->E79D,S       ; #4 CAPTURED POSITION 30
M1430->E79E,S       ; #4 CAPTURED POSITION 31
M1431->E79F,S       ; #4 CAPTURED POSITION 32

;Registers associated with #5 captured data
M1499->A08          ; #5 CAPTURE BUFFER SIZE MASK 
M1500->E7A0,S       ; #5 CAPTURED POSITION 1
M1501->E7A1,S       ; #5 CAPTURED POSITION 2
M1502->E7A2,S       ; #5 CAPTURED POSITION 3
M1503->E7A3,S       ; #5 CAPTURED POSITION 4
M1504->E7A4,S       ; #5 CAPTURED POSITION 5
M1505->E7A5,S       ; #5 CAPTURED POSITION 6
M1506->E7A6,S       ; #5 CAPTURED POSITION 7
M1507->E7A7,S       ; #5 CAPTURED POSITION 8
M1508->E7A8,S       ; #5 CAPTURED POSITION 9
M1509->E7A9,S       ; #5 CAPTURED POSITION 10
M1510->E7AA,S       ; #5 CAPTURED POSITION 11
M1511->E7AB,S       ; #5 CAPTURED POSITION 12
M1512->E7AC,S       ; #5 CAPTURED POSITION 13
M1513->E7AD,S       ; #5 CAPTURED POSITION 14
M1514->E7AE,S       ; #5 CAPTURED POSITION 15
M1515->E7AF,S       ; #5 CAPTURED POSITION 16
M1516->E7B0,S       ; #5 CAPTURED POSITION 17
M1517->E7B1,S       ; #5 CAPTURED POSITION 18
M1518->E7B2,S       ; #5 CAPTURED POSITION 19
M1519->E7B3,S       ; #5 CAPTURED POSITION 20
M1520->E7B4,S       ; #5 CAPTURED POSITION 21
M1521->E7B5,S       ; #5 CAPTURED POSITION 22
M1522->E7B6,S       ; #5 CAPTURED POSITION 23
M1523->E7B7,S       ; #5 CAPTURED POSITION 24
M1524->E7B8,S       ; #5 CAPTURED POSITION 25
M1525->E7B9,S       ; #5 CAPTURED POSITION 26
M1526->E7BA,S       ; #5 CAPTURED POSITION 27
M1527->E7BB,S       ; #5 CAPTURED POSITION 28
M1528->E7BC,S       ; #5 CAPTURED POSITION 29
M1529->E7BD,S       ; #5 CAPTURED POSITION 30
M1530->E7BE,S       ; #5 CAPTURED POSITION 31
M1531->E7BF,S       ; #5 CAPTURED POSITION 32

;Registers associated with #6 captured data
M1599->A09          ; #6 CAPTURE BUFFER SIZE MASK 
M1600->E7C0,S       ; #6 CAPTURED POSITION 1
M1601->E7C1,S       ; #6 CAPTURED POSITION 2
M1602->E7C2,S       ; #6 CAPTURED POSITION 3
M1603->E7C3,S       ; #6 CAPTURED POSITION 4
M1604->E7C4,S       ; #6 CAPTURED POSITION 5
M1605->E7C5,S       ; #6 CAPTURED POSITION 6
M1606->E7C6,S       ; #6 CAPTURED POSITION 7
M1607->E7C7,S       ; #6 CAPTURED POSITION 8
M1608->E7C8,S       ; #6 CAPTURED POSITION 9
M1609->E7C9,S       ; #6 CAPTURED POSITION 10
M1610->E7CA,S       ; #6 CAPTURED POSITION 11
M1611->E7CB,S       ; #6 CAPTURED POSITION 12
M1612->E7CC,S       ; #6 CAPTURED POSITION 13
M1613->E7CD,S       ; #6 CAPTURED POSITION 14
M1614->E7CE,S       ; #6 CAPTURED POSITION 15
M1615->E7CF,S       ; #6 CAPTURED POSITION 16
M1616->E7D0,S       ; #6 CAPTURED POSITION 17
M1617->E7D1,S       ; #6 CAPTURED POSITION 18
M1618->E7D2,S       ; #6 CAPTURED POSITION 19
M1619->E7D3,S       ; #6 CAPTURED POSITION 20
M1620->E7D4,S       ; #6 CAPTURED POSITION 21
M1621->E7D5,S       ; #6 CAPTURED POSITION 22
M1622->E7D6,S       ; #6 CAPTURED POSITION 23
M1623->E7D7,S       ; #6 CAPTURED POSITION 24
M1624->E7D8,S       ; #6 CAPTURED POSITION 25
M1625->E7D9,S       ; #6 CAPTURED POSITION 26
M1626->E7DA,S       ; #6 CAPTURED POSITION 27
M1627->E7DB,S       ; #6 CAPTURED POSITION 28
M1628->E7DC,S       ; #6 CAPTURED POSITION 29
M1629->E7DD,S       ; #6 CAPTURED POSITION 30
M1630->E7DE,S       ; #6 CAPTURED POSITION 31
M1631->E7DF,S       ; #6 CAPTURED POSITION 32

;Registers associated with #7 captured data
M1699->A0A          ; #7 CAPTURE BUFFER SIZE MASK 
M1700->E7E0,S       ; #7 CAPTURED POSITION 1
M1701->E7E1,S       ; #7 CAPTURED POSITION 2
M1702->E7E2,S       ; #7 CAPTURED POSITION 3
M1703->E7E3,S       ; #7 CAPTURED POSITION 4
M1704->E7E4,S       ; #7 CAPTURED POSITION 5
M1705->E7E5,S       ; #7 CAPTURED POSITION 6
M1706->E7E6,S       ; #7 CAPTURED POSITION 7
M1707->E7E7,S       ; #7 CAPTURED POSITION 8
M1708->E7E8,S       ; #7 CAPTURED POSITION 9
M1709->E7E9,S       ; #7 CAPTURED POSITION 10
M1710->E7EA,S       ; #7 CAPTURED POSITION 11
M1711->E7EB,S       ; #7 CAPTURED POSITION 12
M1712->E7EC,S       ; #7 CAPTURED POSITION 13
M1713->E7ED,S       ; #7 CAPTURED POSITION 14
M1714->E7EE,S       ; #7 CAPTURED POSITION 15
M1715->E7EF,S       ; #7 CAPTURED POSITION 16
M1716->E7F0,S       ; #7 CAPTURED POSITION 17
M1717->E7F1,S       ; #7 CAPTURED POSITION 18
M1718->E7F2,S       ; #7 CAPTURED POSITION 19
M1719->E7F3,S       ; #7 CAPTURED POSITION 20
M1720->E7F4,S       ; #7 CAPTURED POSITION 21
M1721->E7F5,S       ; #7 CAPTURED POSITION 22
M1722->E7F6,S       ; #7 CAPTURED POSITION 23
M1723->E7F7,S       ; #7 CAPTURED POSITION 24
M1724->E7F8,S       ; #7 CAPTURED POSITION 25
M1725->E7F9,S       ; #7 CAPTURED POSITION 26
M1726->E7FA,S       ; #7 CAPTURED POSITION 27
M1727->E7FB,S       ; #7 CAPTURED POSITION 28
M1728->E7FC,S       ; #7 CAPTURED POSITION 29
M1729->E7FD,S       ; #7 CAPTURED POSITION 30
M1730->E7FE,S       ; #7 CAPTURED POSITION 31
M1731->E7FF,S       ; #7 CAPTURED POSITION 32

;Registers associated with #8 captured data
M1799->A0B          ; #8 CAPTURE BUFFER SIZE MASK 
M1800->E800,S       ; #8 CAPTURED POSITION 1
M1801->E801,S       ; #8 CAPTURED POSITION 2
M1802->E802,S       ; #8 CAPTURED POSITION 3
M1803->E803,S       ; #8 CAPTURED POSITION 4
M1804->E804,S       ; #8 CAPTURED POSITION 5
M1805->E805,S       ; #8 CAPTURED POSITION 6
M1806->E806,S       ; #8 CAPTURED POSITION 7
M1807->E807,S       ; #8 CAPTURED POSITION 8
M1808->E808,S       ; #8 CAPTURED POSITION 9
M1809->E809,S       ; #8 CAPTURED POSITION 10
M1810->E80A,S       ; #8 CAPTURED POSITION 11
M1811->E80B,S       ; #8 CAPTURED POSITION 12
M1812->E80C,S       ; #8 CAPTURED POSITION 13
M1813->E80D,S       ; #8 CAPTURED POSITION 14
M1814->E80E,S       ; #8 CAPTURED POSITION 15
M1815->E80F,S       ; #8 CAPTURED POSITION 16
M1816->E810,S       ; #8 CAPTURED POSITION 17
M1817->E811,S       ; #8 CAPTURED POSITION 18
M1818->E812,S       ; #8 CAPTURED POSITION 19
M1819->E813,S       ; #8 CAPTURED POSITION 20
M1820->E814,S       ; #8 CAPTURED POSITION 21
M1821->E815,S       ; #8 CAPTURED POSITION 22
M1822->E816,S       ; #8 CAPTURED POSITION 23
M1823->E817,S       ; #8 CAPTURED POSITION 24
M1824->E818,S       ; #8 CAPTURED POSITION 25
M1825->E819,S       ; #8 CAPTURED POSITION 26
M1826->E81A,S       ; #8 CAPTURED POSITION 27
M1827->E81B,S       ; #8 CAPTURED POSITION 28
M1828->E81C,S       ; #8 CAPTURED POSITION 29
M1829->E81D,S       ; #8 CAPTURED POSITION 30
M1830->E81E,S       ; #8 CAPTURED POSITION 31
M1831->E81F,S       ; #8 CAPTURED POSITION 32


;The followings are P-Variables

; End PLC 1 initial valve setting*********************************************
P0..2047=0
Q0..2047=0
&1
#1->0
#2->0
#3->0
#4->0
&2
#1->0
#2->0
#3->0
#4->0
&1
#1->1000X
#2->1000Y
#3->1000Z
#4->1000A
&2
&1


P100=100           ;X AXIS JOG SPEED 100 Deg/min
P200=100           ;Y AXES JOG SPEED 100 Deg/min
P300=100           ;Z AXES JOG SPEED 100 Deg/min
P400=100           ;A AXES JOG SPEED 100 Deg/min

P101=0             ;X +TRAVEL RANGE
P201=0             ;Y +TRAVEL RANGE
P301=0             ;Z +TRAVEL RANGE
P401=0             ;A +TRAVEL RANGE

P114=0             ;X -TRAVEL RANGE
P214=0             ;Y -TRAVEL RANGE
P314=0             ;Z -TRAVEL RANGE
P414=0             ;A -TRAVEL RANGE

P102=10000         ;X DRIVER ENCODER OUTPUT (PULSE/REV)    
P202=10000         ;Y DRIVER ENCODER OUTPUT (PULSE/REV)   
P302=10000         ;Z DRIVER ENCODER OUTPUT (PULSE/REV)  
P402=10000         ;A DRIVER ENCODER OUTPUT (PULSE/REV)  

P112=360           ;X BALL SCREW PITCH
P212=360           ;Y BALL SCREW PITCH
P312=360           ;Z BALL SCREW PITCH
P412=360           ;A BALL SCREW PITCH

P113=100           ;X REDUCER RATIO 
P213=100           ;Y REDUCER RATIO  ==>20
P313=100           ;Z REDUCER RATIO 
P413=50            ;A REDUCER RATIO  
 
P103=P102*4/(P112/P113)   ;X PULSE/1Deg
P203=P202*4/(P212/P213)   ;Y PULSE/1Deg
P303=P302*4/(P312/P313)   ;Z PULSE/1Deg
P403=P402*4/(P412/P413)   ;A PULSE/1Deg

M191=P103                 ;X PULSE/1Deg CPU
M291=P203                 ;Y PULSE/1Deg CPU
M391=P303                 ;Z PULSE/1Deg CPU
M491=P403                 ;A PULSE/1Deg CPU      

P104=4.32            ;X HOME OFFSET UP Deg
P204=0           ;Y HOME OFFSET UP Deg
P304=4.5         ;Z HOME OFFSET UP Deg
P404=6.17             ;A HOME OFFSET UP Deg
 
P105=0             ;X HOME PROCESSING FLAG
P205=0             ;Y HOME PROCESSING FLAG
P305=0             ;Z HOME PROCESSING FLAG
P405=0             ;A HOME PROCESSING FLAG

P109=0             ;X HOMING SPEED BUFFER 
P209=0             ;Y HOMING SPEED BUFFER 
P309=0             ;Z HOMING SPEED BUFFER 
P409=0             ;A HOMING SPEED BUFFER 

P110=250           ;X HOME SENSOR SPEED 250Deg/min
P210=250           ;Y HOME SENSOR SPEED 250Deg/min
P310=250           ;Z HOME SENSOR SPEED 250Deg/min
P410=250           ;A HOME SENSOR SPEED 250Deg/min

P111=-50            ;X HOME INDEX SPEED 50 Deg/min 
P211=-50            ;Y HOME INDEX SPEED 50 Deg/min 
P311=-50            ;Z HOME INDEX SPEED 50 Deg/min 
P411=-50            ;A HOME INDEX SPEED 50 Deg/min

M102=0
M202=0
M302=0
M402=0
I186=100
I286=100
I386=100
I486=100

;**********Start PLC*********************************************************** 
M899->9B5,0,8       ; ABORT FLAG vvvvv(not 9B8 error) #1~8
OPEN PLC 1 CLEAR
DISPLC2
DISPLC3
DISPLC4
DISPLC5
DISPLC6
DISPLC11
DISPLC12
DISPLC13
DISPLC14
DISPLC7
DISPLC15
DISPLC9
CMD"#1J/#2J/#3J/#4J/"
M72=10
WHILE(M72>0)
ENDW
P105=0
P205=0
P305=0
P405=0
P61=0
P62=0
P63=0
P64=0
;**************************************************************
;*****************DH Parameters==>Have to been Key in**********
;Q1009=0        ;d1
;Q1010=110       ;a1
;Q1011=280       ;a2
;Q1012=280       ;a3a
;Q1013=80       ;a3
;Q1014=140.00       ;d4
;**************************************************************
;**************************************************************
P991=0
DISPLC1
CLOSE

OPEN PLC 2 CLEAR
I181=9
I281=9
I381=9
I481=9
I105=0
I205=0
I305=0
I405=0
I107=P103/60*P111
I207=P203/60*P211
I307=P303/60*P311
I407=P403/60*P411
I108=P103*P104
I208=P203*P204
I308=P303*P304
I408=P403*P404
CMD"#1HM#2HM#3HM#4HM"
DISPLC2
CLOSE

OPEN PLC3 CLEAR
I105=0
I205=0
I305=0
I405=0
M76=100
WHILE(M76>0)
ENDW
CMD"&1B13R"
WHILE(M180!=0)
ENDW
M76=100
WHILE(M76>0)
ENDW
CMD"&1B21R"
DISPLC3
CLOSE

OPEN PLC 4 CLEAR
IF(P1000=1)
  Q2009=1
ELSE
  Q2009=0
ENDI
IF(M22=1ANDM23=1ANDM24=1ANDM25=1ANDM26=1ANDM27=0ANDM28=0ANDP2047=0ANDQ2009=1)
  P2047=1
  Q(P2041)=(M161+M172)/M191
  Q(P2042)=(M261+M272)/M291
  Q(P2043)=(M361+M372)/M391
  Q(P2043)=(M461+M472)/M491
  Q2016=Q(P2041)
  Q2017=Q(P2042)
  Q2018=Q(P2043)
  Q2019=Q(P2044)
  P2041=P2041+4
  P2042=P2042+4
  P2043=P2043+4
  P2044=P2044+4
  SENDC1"*****Angle Data******"
  SENDC1"Th1 Angle Degree  : @Q2016"
  SENDC1"Th2 Angle Degree  : @Q2017"
  SENDC1"th3 Angle Degree  : @Q2018"
  SENDC1"Th4 Angle Degree  : @Q2018"
  SENDC1" "
ENDI
IF(M27=1ORM28=1)
  IF(P2047=1)
    P2047=0
  ENDI
ENDI
CLOSE

OPEN PLC 6 CLEAR
  CMD"RESPLC11"
  CMD"RESPLC12"
  CMD"RESPLC13"
  CMD"RESPLC14"
  DISPLC6
CLOSE

P61=0
P62=0
P63=0
P64=0
OPEN PLC 8 CLEAR
M714=0
M814=0
I110=P103*P101
I111=-P103*P114
I210=P203*P201
I211=-P203*P214
I310=P303*P301
I311=-P303*P314
I410=P403*P401
I411=-P403*P414

IF(P991=1)
P991=0
M71=200
WHILE (M71>0)
ENDW
CMD"NEXT" 
CMD"R"
ENDIF

IF(M13=1 OR M14=1 OR M15=1 OR M16=1 OR M21=1 OR M22=1)
  P60=1
ELSE
  P60=0
ENDI
IF(P60=0 OR P61=1 OR P62=1 OR P63=1 OR P64=1)
  M2=0
ELSE
  IF(M12=0)
    P991=0
    CMD^A
    WHILE(M899!=0)
    ENDW
  ENDI
  M2=1
ENDI
IF(M131=1 OR M132=1 OR M231=1 OR M232=1 OR M331=1 OR M332=1 OR M431=1 OR M432=1)
  P991=0
  CMD^A
  WHILE(M899!=0)
  ENDW
ENDI
IF(M11=1ANDM12=1)
  IF(P2007<200)
    P2007=P2007+1
  ENDI
  IF(P2007>198)
    IF(FABS(M102-I129)>150 OR FABS(M202-I229)>150 OR FABS(M302-I329)>150 OR FABS(M402-I429)>150)
      CMD"#1J/#2J/#3J/#4J/"
      M71=10
      WHILE(M71>0)
      ENDW
      CMD^K
      M71=10
      WHILE(M71>0)
      ENDW
      P50=1
    ENDI
  ENDI
ELSE
  P2007=0
ENDI
IF(M11=0ANDM12=0ANDP50=1)
  CMD^K
  M71=10
  WHILE(M71>0)
  ENDW
  P991=0
  CMD^A
  WHILE(M899!=0)
  ENDW
  CMD^K
  M71=10
  WHILE(M71>0)
  ENDW
  CMD"#1J/#2J/#3J/#4J/"
  M71=10
  WHILE(M71>0)
  ENDW
  CMD"RESPLC1"
  M145=0
  M245=0
  M345=0
  M445=0
  P50=0
ENDI
IF(M11=0)
  IF(P51=0)
    CMD^K
    M71=10
    WHILE(M71>0)
    ENDW
    M1=0
    M71=100
    WHILE(M71>0)
    ENDW
    CMD^K
    M71=2000
    WHILE(M71>0)
    ENDW
    P991=0
    CMD^A
    WHILE(M899!=0)
    ENDW
    CMD"#1J/#2J/#3J/#4J/"
    M71=10
    WHILE(M71>0)
    ENDW
    P51=1
  ENDI
ENDI
IF(M12=0)
  IF(M143=1 OR M243=1 OR M343=1 OR M443=1)
    M1=1
    P991=0
    CMD^A
    WHILE(M899!=0)
    ENDW
    CMD^K
    M71=10
    WHILE(M71>0)
    ENDW
    CMD"#1J/#2J/#3J/#4J/"
    M71=10
    WHILE(M71>0)
    ENDW
    CMD"RESPLC1"
    M145=0
    M245=0
    M345=0
    M445=0
    M71=100
    WHILE(M71>0)
    ENDW
    CMD^K
    M71=10
    WHILE(M71>0)
    ENDW
  ENDI
  IF(M144=1 OR M244=1 OR M344=1 OR M444=1)
    P991=0
    CMD^A
    WHILE(M899!=0)
    ENDW
    CMD^K
    M71=10
    WHILE(M71>0)
    ENDW
    CMD"#1J/#2J/#3J/#4J/"
    M71=10
    WHILE(M71>0)
    ENDW
    CMD"RESPLC1"
    M145=0
    M245=0
    M345=0
    M445=0
  ENDI
ENDI
IF(M11=1)
  M1=1
  IF(P51=1)
    P991=0
    CMD^A
    WHILE(M899!=0)
    ENDW
    CMD^K
    M71=10
    WHILE(M71>0)
    ENDW
    CMD"#1J/#2J/#3J/#4J/"
    M71=10
    WHILE(M71>0)
    ENDW
    CMD"RESPLC1"
    M145=0
    M245=0
    M345=0
    M445=0
    M71=100
    WHILE(M71>0)
    ENDW
    CMD^K
    M71=10
    WHILE(M71>0)
    ENDW
  ENDI
  P51=0
  P105=0
  P205=0
  P305=0
  P405=0
  P116=1
  P117=1
  P118=1
ENDI
CLOSE

P116=1
P117=1
P118=1
OPEN PLC10 CLEAR
I103=P100/60*P103
I203=P200/60*P203
I303=P300/60*P303
I403=P400/60*P403
IF(M23=0 OR M24=0 OR M25=0 OR M26=0)
  P528=1
ELSE
  P528=0
ENDI
IF(P105=0 AND P205=0 AND P305=0 AND P405=0 AND P528=1)
  IF(M23=0)
    I105=1
    I205=0
    I305=0
    I405=0
  ENDI
  IF(M24=0)
    I105=0
    I205=1
    I305=0
    I405=0
  ENDI
  IF(M25=0)
    I105=0
    I205=0
    I305=1
    I405=0
  ENDI
  IF(M26=0)
    I105=0
    I205=0
    I305=0
    I405=1
  ENDI
ELSE
  I105=0
  I205=0
  I305=0
  I405=0
ENDI
IF(M27=1 AND M28=1)
  I106=(-0.1*P103/4/100)
  I206=(-0.1*P203/4/100)
  I306=(-0.1*P303/4/100)
  I406=(-0.1*P403/4/100)
ENDI
IF(M27=0)
  I106=(-1*P103/4/100)
  I206=(-1*P203/4/100)
  I306=(-1*P303/4/100)
  I406=(-1*P403/4/100)
ENDI
IF(M28=0)
  I106=(-10*P103/4/100)
  I206=(-10*P203/4/100)
  I306=(-10*P303/4/100)
  I406=(-10*P403/4/100)
ENDI
CLOSE

P105=0
OPEN PLC 11 CLEAR
P1331=I117
I117=0
I105=0
I181=11
I182=0
P105=1
I108=P103*P104   
P109=I103
I103=P103/60*P110   
I107=P103/60*P111
P524=P101
P519=P114     
P101=0
P114=0
I110=0
I111=0
M145=0
P61=1
CMD"#1J-"
M72=2
WHILE(M72>0)
ENDW
WHILE(M120=1 AND M14=0)
ENDW
M72=50
WHILE(M72>0)
CMD"#1J/"
ENDW
M72=2
WHILE(M72>0)
ENDW
IF(M14=1)
  I103=P103/60*P110  
  CMD"#1J+"
  M72=2
  WHILE(M72>0)
  ENDW
ENDIF
WHILE(M120=1 AND M13=0)
ENDW
P61=0
IF(M13=1)
DISPLC11
ENDIF
I181=11
M72=50
WHILE(M72>0)
CMD"#1J/"
ENDW
M72=2
WHILE(M72>0)
ENDW
CMD"#1HM"
WHILE(M145=0)
ENDW
M72=1000
WHILE(M72>0)
ENDW
I103=P109
P101=P524
P114=P519
I110=P103*P101  ; Positive software limit
I111=-P103*P114 ; Negative software limit
M72=1000
WHILE(M72>0)
ENDW
DISPLC11
I117=P1331
P105=0
CLOSE

P205=0
OPEN PLC 12 CLEAR
P1332=I217
I217=0
I205=0
I281=11
I282=0
P205=1
I208=P203*P204   
P209=I203
I203=P203/60*P210  
I207=P203/60*P211
P523=P201
P518=P214
P201=0
P214=0
I210=0
I211=0
M245=0
P62=1
CMD"#2J-"
M73=2
WHILE(M73>0)
ENDW
WHILE(M220=1 AND M16=0)
ENDW
M73=50
WHILE(M73>0)
CMD"#2J/"
ENDW
M73=2
WHILE(M73>0)
ENDW
IF(M16=1)
  I203=P203/60*P210  
  CMD"#2J+"
  M73=2
  WHILE(M73>0)
  ENDW
ENDIF
WHILE(M220=1 AND M15=0)
ENDW
P62=0
IF(M15=1)
DISPLC12
ENDIF
I281=11
M73=50
WHILE(M73>0)
CMD"#2J/"
ENDW
M73=2
WHILE(M73>0)
ENDW
CMD"#2HM"
WHILE(M245=0)
ENDW
M73=1000
WHILE(M73>0)
ENDW
I203=P209
P201=P523
P214=P518
I210=P203*P201     ; Positive software limit
I211=-P203*P214              ; Negative software limit
M73=1000
WHILE(M73>0)
ENDW
DISPLC12
I217=P1332
P205=0
CLOSE

P305=0
OPEN PLC 13 CLEAR
P1333=I317
I317=0
I305=0
I381=11
I382=0
P305=1
I308=P303*P304   
P309=I303
I303=P303/60*P310 
I307=P303/60*P311  
P525=P301
P521=P314
P301=0
P314=0
I310=0
I311=0
M345=0
P63=1
CMD"#3J-"
M74=2
WHILE(M74>0)
ENDW
WHILE(M320=1 AND M18=0)
ENDW
M74=50
WHILE(M74>0)
CMD"#3J/"
ENDW
M74=2
WHILE(M74>0)
ENDW
IF(M18=1)
  I303=P303/60*P310 
  CMD"#3J+"
  M74=2
  WHILE(M74>0)
  ENDW
ENDIF
WHILE(M320=1 AND M17=0)
ENDW
P63=0
IF(M17=1)
DISPLC13
ENDIF
I381=11
M74=50
WHILE(M74>0)
CMD"#3J/"
ENDW
M74=2
WHILE(M74>0)
ENDW
CMD"#3HM"
WHILE(M345=0)
ENDW
M74=1000
WHILE(M74>0)
ENDW
I303=P309
P301=P525
P314=P521
I310=P303*P301     ; Positive software limit
I311=-P303*P314          ; Negative software limit
M74=1000
WHILE(M74>0)
ENDW
DISPLC13
I317=P1333
P305=0
CLOSE

P405=0
OPEN PLC 14 CLEAR
P1334=I417
I417=0
I405=0
I481=11
I482=0
P405=1
I408=P403*P404  
P409=I403
I403=P403/60*P410 
I407=P403/60*P411  
P526=P401
P522=P414
P401=0
P414=0
I410=0
I411=0
M445=0
P64=1
CMD"#4J-"
M75=2
WHILE(M75>0)
ENDW
WHILE(M420=1 AND M22=0)
ENDW
M75=50
WHILE(M75>0)
CMD"#4J/"
ENDW
M75=2
WHILE(M75>0)
ENDW
IF(M22=1)
  I403=P403/60*P410 
  CMD"#4J+"
  M75=2
  WHILE(M75>0)
  ENDW
ENDIF
WHILE(M420=1 AND M21=0)
ENDW
P64=0
IF(M21=1)
DISPLC14
ENDIF
I481=11
M75=50
WHILE(M75>0)
CMD"#4J/"
ENDW
M75=2
WHILE(M75>0)
ENDW
CMD"#4HM"
WHILE(M445=0)
ENDW
M75=1000
WHILE(M75>0)
ENDW
I403=P409
P401=P526
P414=P522
I410=P403*P401     ; Positive software limit
I411=-P403*P414           ; Negative software limit
M75=1000
WHILE(M75>0)
ENDW
DISPLC14
I417=P1334
P405=0
CLOSE

OPEN PROG11 CLEAR
I105=0
I205=0
I305=0
I405=0
Q1009=69.2
Q1010=107.4
Q1011=280
Q1012=280
Q1013=82.5
Q1014=140
DISPLC10
Q1031=0
Q1032=0
Q1033=0
Q1034=0
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))
P1020=M462/M491-M162/M191
Q1027=P1017
Q1028=P1018
Q1029=P1019
Q1030=P1020
M86=0
F10000
TA150
TS100
ABS
N1
IF(M23=0)
  IF(Q1031=0)
    Q1031=1
    Q1032=0
    Q1033=0
    Q1034=0
    Q1027=P1017
    M86=0
  ENDI
  IF(M27=1ANDM28=1)
    P1017=Q1027-0.01*M86/4
  ENDI
  IF(M27=0)
    P1017=Q1027-0.1*M86/4
  ENDI
  IF(M28=0)
    P1017=Q1027-1*M86/4
  ENDI
ENDI
IF(M24=0)
  IF(Q1032=0)
    Q1031=0
    Q1032=1
    Q1033=0
    Q1034=0
    Q1028=P1018
    M86=0
  ENDI
  IF(M27=1ANDM28=1)
    P1018=Q1028-0.01*M86/4
  ENDI
  IF(M27=0)
    P1018=Q1028-0.1*M86/4
  ENDI
  IF(M28=0)
    P1018=Q1028-1*M86/4
  ENDI
ENDI
IF(M25=0)
  IF(Q1033=0)
    Q1031=0
    Q1032=0
    Q1033=1
    Q1034=0
    Q1029=P1019
    M86=0
  ENDI
  IF(M27=1ANDM28=1)
    P1019=Q1029-0.01*M86/4
  ENDI
  IF(M27=0)
    P1019=Q1029-0.1*M86/4
  ENDI
  IF(M28=0)
    P1019=Q1029-1*M86/4
  ENDI
ENDI
IF(M26=0)
  IF(Q1034=0)
    Q1031=0
    Q1032=0
    Q1033=0
    Q1034=1
    Q1030=P1020
    M86=0
  ENDI
  IF(M27=1ANDM28=1)
    P1020=Q1030-0.01*M86/4
  ENDI
  IF(M27=0)
    P1020=Q1030-0.1*M86/4
  ENDI
  IF(M28=0)
    P1020=Q1030-1*M86/4
  ENDI
ENDI
Q1005=ATAN(P1018/P1017)
Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
Q1024=2*Q1011*Q1012
Q1007=ACOS(Q1023/Q1024)
Q1020=Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018=P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022=Q1011+Q1012*COS(Q1007)
Q1006=-ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008=P1020+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWE1
GOTO1
CLOSE


OPEN PROG12 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog12 is real executed*******************
ABS
F3000
TA50
TS100
LIN Y-46.2189Z0
;*********************Simulation Only Start; Take off this portion when real executed*******************
DWELL100
;************************Parameters Definition****************
;Q1001           ;Px    Cartesian Coordinate X Position  		Unit:mm  
;Q1002           ;Py    Cartesian Coordinate y Position  		Unit:mm  
;Q1003           ;Pz    Cartesian Coordinate z Position  		Unit:mm 
;Q1004           ;q4    Cartesian Coordinate #4 Axis Rotation Angle     Unit:Deg 
;Q1005           ;th1   Joint Space #1 Joint Rotation Angle
;Q1006           ;th2   Joint Space #2 Joint Rotation Angle 
;Q1007           ;th3   Joint Space #4 Joint Rotation Angle
;Q1008           ;th4   Joint Space #5 Joint Rotation Angle
;**************************************************************

;*****************DH Parameters==>Have to been Key in**********
Q1009=69.2        ;d1
Q1010=107.4       ;a1
Q1011=280       ;a2
Q1012=280       ;a3a
Q1013=82.5       ;a3
Q1014=140.00      ;d4
;**************************************************************

;*****************Inverse Kinermatic Equation******************
;Q1005= ATAN(Q1002/Q1001)  ;th1
;Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
;Q1024= 2*Q1011*Q1012
;Q1007= ACOS(Q1023/Q1024)   ;th3
;Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
;Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
;Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
;Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
;Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
;Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1022= Q1011+Q1012*COS(Q1007)
;Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)   ;th2
;Q1008= Q1004+Q1005   ;th4
;Q1007=Q1007+Q1006    ;Real th3 Command
;**************************************************************

;************ Start Of Cartesian Coordinate Position/Pose Point #1***************
Q1=590
Q2=0
Q3=230
Q4=0
;************ End Of Cartesian Coordinate Position/Pose Point   #1***************

;************ Start Of Cartesian Coordinate Position/Pose Point #2***************
Q5=590
Q6=0
Q7=130
Q8=0
;************ End Of Cartesian Coordinate Position/Pose Point   #2***************

;************ Start Of Cartesian Coordinate Position/Pose Point #3***************
Q9=590
Q10=0
Q11=230
Q12=0
;************ End Of Cartesian Coordinate Position/Pose Point   #3***************

;************ Start Of Cartesian Coordinate Position/Pose Point #4***************
Q13=490
Q14=0
Q15=230
Q16=0
;************ End Of Cartesian Coordinate Position/Pose Point   #4***************

;************ Start Of Cartesian Coordinate Position/Pose Point #5***************
Q17=1590
Q18=0
Q19=230
Q20=0
;************ End Of Cartesian Coordinate Position/Pose Point   #5***************

;************ Start Of Cartesian Coordinate Position/Pose Point #6***************
Q21=1590
Q22=0
Q23=130
Q24=0
;************ End Of Cartesian Coordinate Position/Pose Point   #6***************
;************ Start Of Cartesian Coordinate Position/Pose Point #7***************
Q25=1590
Q26=0
Q27=230
Q28=0
;************ End Of Cartesian Coordinate Position/Pose Point   #7***************
;************ Start Of Cartesian Coordinate Position/Pose Point #8***************
Q29=1490
Q30=0
Q31=230
Q32=0
;************ End Of Cartesian Coordinate Position/Pose Point   #8***************
;************ Start Of Cartesian Coordinate Position/Pose Point #9***************
Q33=470
Q34=0
Q35=280
Q36=0
;************ End Of Cartesian Coordinate Position/Pose Point   #9***************
;************ Start Of Cartesian Coordinate Position/Pose Point #10***************
Q37=0
Q38=0
Q39=0
Q40=0
;************ End Of Cartesian Coordinate Position/Pose Point   #10***************
;************ Start Of Cartesian Coordinate Position/Pose Point #11***************
Q41=0
Q42=0
Q43=0
Q44=0
;************ End Of Cartesian Coordinate Position/Pose Point   #11***************
;************ Start Of Cartesian Coordinate Position/Pose Point #12***************
Q45=0
Q46=0
Q47=0
Q48=0
;************ End Of Cartesian Coordinate Position/Pose Point   #12***************
;************ Start Of Cartesian Coordinate Position/Pose Point #13***************
Q49=0
Q50=0
Q51=0
Q52=0
;************ End Of Cartesian Coordinate Position/Pose Point   #13***************
;************ Start Of Cartesian Coordinate Position/Pose Point #14***************
Q53=0
Q54=0
Q55=0
Q56=0
;************ End Of Cartesian Coordinate Position/Pose Point   #14***************
;************ Start Of Cartesian Coordinate Position/Pose Point #15***************
Q57=0
Q58=0
Q59=0
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #15***************

;以此類推
CMD"GAT"
N2
Q1005=0      ;th1=0
Q1006=0      ;th2=0
Q1007=0      ;th3=0
Q1008=0      ;th4=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
;**************************************************************
;**************************************************************
N1
Q1025=0
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)<=-1000 OR Q(Q2041)>=1000)
    Q1025=1
    DWELL1
    GOTO5
  ENDIF
ELSE
  DWELL1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDIF
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDIF
Q1005= ATAN(Q1002/Q1001) 
Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024= 2*Q1011*Q1012
Q1007= ACOS(Q1023/Q1024)
Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022= Q1011+Q1012*COS(Q1007)
Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008= Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
DWELL1
CMD"ENDG"
  CMD^A
GOTO2
;**************************************************************
;**************************************************************
;**************************************************************
Q2041=1
Q2042=2
Q2043=3
Q2044=4
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Px
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Py
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))                   ;Pz
P1020=M462/M491-M162/M191                                                                           ;q4  Ref. To Base
I150=1
I186=100
I286=100
I386=100
I486=100
P994=10     ; Linear IK number
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000 AND Q(Q2041)<1000)
    Q1025=0
    DWELL1
    GOTO1
  ENDIF
ELSE
  DWELL1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDIF
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDIF
IF(P1=0)
  P1=0.01
ENDIF
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005= ATAN(P1018/P1017) 
  Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024= 2*Q1011*Q1012
  Q1007= ACOS(Q1023/Q1024)
  Q1020= Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018= P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022= Q1011+Q1012*COS(Q1007)
  Q1006= -ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008= P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4

IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
DWELL1
CMD"ENDG"
  CMD^A
GOTO2
CLOSE

OPEN PROG13 CLEAR
PSET Y-90
CLOSE

OPEN PROG21 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog21 Go Back to 43.8deg. is real executed*******************

ABS
F7000
TA200
TS100
LIN Y-90Z0
;*********************Simulation Only Start; Take off this portion when real executed*******************
DWELL100
;************************Parameters Definition****************
;Q1001           ;Px    Cartesian Coordinate X Position  		Unit:mm  
;Q1002           ;Py    Cartesian Coordinate y Position  		Unit:mm  
;Q1003           ;Pz    Cartesian Coordinate z Position  		Unit:mm 
;Q1004           ;q4    Cartesian Coordinate #4 Axis Rotation Angle     Unit:Deg 
;Q1005           ;th1   Joint Space #1 Joint Rotation Angle
;Q1006           ;th2   Joint Space #2 Joint Rotation Angle 
;Q1007           ;th3   Joint Space #4 Joint Rotation Angle
;Q1008           ;th4   Joint Space #5 Joint Rotation Angle
;**************************************************************

;*****************DH Parameters==>Have to been Key in**********
Q1009=69.2        ;d1
Q1010=107.4       ;a1
Q1011=280       ;a2
Q1012=280       ;a3a
Q1013=82.5       ;a3
Q1014=140.00       ;d4
;**************************************************************

;*****************Inverse Kinermatic Equation******************
;Q1005= ATAN(Q1002/Q1001)  ;th1
;Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
;Q1024= 2*Q1011*Q1012
;Q1007= ACOS(Q1023/Q1024)   ;th3
;Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
;Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
;Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
;Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
;Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
;Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1022= Q1011+Q1012*COS(Q1007)
;Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)   ;th2
;Q1008= Q1004+Q1005   ;th4
;Q1007=Q1007+Q1006    ;Real th3 Command
;**************************************************************

;************ Start Of Cartesian Coordinate Position/Pose Point #1***************
Q1=652.686
Q2=0
Q3=141.308
Q4=0
;************ End Of Cartesian Coordinate Position/Pose Point   #1***************

;************ Start Of Cartesian Coordinate Position/Pose Point #2***************
Q5=0
Q6=0
Q7=0
Q8=0
;************ End Of Cartesian Coordinate Position/Pose Point   #2***************

;************ Start Of Cartesian Coordinate Position/Pose Point #3***************
Q9=470
Q10=0
Q11=88
Q12=0
;************ End Of Cartesian Coordinate Position/Pose Point   #3***************

;************ Start Of Cartesian Coordinate Position/Pose Point #4***************
Q13=620
Q14=150
Q15=88
Q16=0
;************ End Of Cartesian Coordinate Position/Pose Point   #4***************

;************ Start Of Cartesian Coordinate Position/Pose Point #5***************
Q17=620
Q18=150
Q19=63
Q20=0
;************ End Of Cartesian Coordinate Position/Pose Point   #5***************

;************ Start Of Cartesian Coordinate Position/Pose Point #6***************
Q21=620
Q22=150
Q23=88
Q24=0
;************ End Of Cartesian Coordinate Position/Pose Point   #6***************
;************ Start Of Cartesian Coordinate Position/Pose Point #7***************
Q25=620
Q26=-150
Q27=88
Q28=0
;************ End Of Cartesian Coordinate Position/Pose Point   #7***************
;************ Start Of Cartesian Coordinate Position/Pose Point #8***************
Q29=620
Q30=-150
Q31=63
Q32=0
;************ End Of Cartesian Coordinate Position/Pose Point   #8***************
;************ Start Of Cartesian Coordinate Position/Pose Point #9***************
Q33=620
Q34=-150
Q35=88
Q36=0
;************ End Of Cartesian Coordinate Position/Pose Point   #9***************
;************ Start Of Cartesian Coordinate Position/Pose Point #10***************
Q37=320
Q38=-150
Q39=88
Q40=0
;************ End Of Cartesian Coordinate Position/Pose Point   #10***************
;************ Start Of Cartesian Coordinate Position/Pose Point #11***************
Q41=320
Q42=-150
Q43=63
Q44=0
;************ End Of Cartesian Coordinate Position/Pose Point   #11***************
;************ Start Of Cartesian Coordinate Position/Pose Point #12***************
Q45=320
Q46=-150
Q47=88
Q48=0
;************ End Of Cartesian Coordinate Position/Pose Point   #12***************
;************ Start Of Cartesian Coordinate Position/Pose Point #13***************
Q49=320
Q50=150
Q51=88
Q52=0
;************ End Of Cartesian Coordinate Position/Pose Point   #13***************
;************ Start Of Cartesian Coordinate Position/Pose Point #14***************
Q53=320
Q54=150
Q55=63
Q56=0
;************ End Of Cartesian Coordinate Position/Pose Point   #14***************
;************ Start Of Cartesian Coordinate Position/Pose Point #15***************
Q57=320
Q58=150
Q59=88
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #15***************
;************ Start Of Cartesian Coordinate Position/Pose Point #16***************
Q57=470
Q58=0
Q59=88
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #16***************
;************ Start Of Cartesian Coordinate Position/Pose Point #17***************
Q57=470
Q58=0
Q59=280
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #17***************
;************ Start Of Cartesian Coordinate Position/Pose Point #18***************
Q57=0
Q58=0
Q59=0
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #18***************
;************ Start Of Cartesian Coordinate Position/Pose Point #19***************
Q57=0
Q58=0
Q59=0
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #19***************
;************ Start Of Cartesian Coordinate Position/Pose Point #20***************
Q57=0
Q58=0
Q59=0
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #20***************
;以此類推
CMD"GAT"
N2
Q1005=0      ;th1=0
Q1006=0      ;th2=0
Q1007=0      ;th3=0
Q1008=0      ;th4=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
;**************************************************************
;**************************************************************
N1
Q1025=0
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)<=-1000 OR Q(Q2041)>=1000)
    Q1025=1
    DWELL1
    GOTO5
  ENDIF
ELSE
  DWELL1
  CMD"ENDG"
  CMD^A
  GOTO2 
ENDIF
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDIF
Q1005= ATAN(Q1002/Q1001) 
Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024= 2*Q1011*Q1012
Q1007= ACOS(Q1023/Q1024)
Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022= Q1011+Q1012*COS(Q1007)
Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008= Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
DWELL1
CMD"ENDG"
  CMD^A
  GOTO2
;**************************************************************
;**************************************************************
;**************************************************************
Q2041=1
Q2042=2
Q2043=3
Q2044=4
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Px
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Py
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))                   ;Pz
P1020=M462/M491-M162/M191                                                                           ;q4  Ref. To Base
I150=1
I186=100
I286=100
I386=100
I486=100
P994=10     ; Linear IK number
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000 AND Q(Q2041)<1000)
    Q1025=0
    DWELL1
    GOTO1
  ENDIF
ELSE
  DWELL1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDIF
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDIF
IF(P1=0)
  P1=0.01
ENDIF
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005= ATAN(P1018/P1017) 
  Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024= 2*Q1011*Q1012
  Q1007= ACOS(Q1023/Q1024)
  Q1020= Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018= P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022= Q1011+Q1012*COS(Q1007)
  Q1006= -ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008= P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4

IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
DWELL1
CMD"ENDG"
  CMD^A
GOTO2
CLOSE

OPEN PROG22 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog22 For Task 1&2 is real executed*******************
P1023=0

ABS
F7000
TA200
TS100

;*********************Simulation Only Start; Take off this portion when real executed*******************
;************************Parameters Definition****************
;Q1001           ;Px    Cartesian Coordinate X Position  		Unit:mm  
;Q1002           ;Py    Cartesian Coordinate y Position  		Unit:mm  
;Q1003           ;Pz    Cartesian Coordinate z Position  		Unit:mm 
;Q1004           ;q4    Cartesian Coordinate #4 Axis Rotation Angle     Unit:Deg 
;Q1005           ;th1   Joint Space #1 Joint Rotation Angle
;Q1006           ;th2   Joint Space #2 Joint Rotation Angle 
;Q1007           ;th3   Joint Space #4 Joint Rotation Angle
;Q1008           ;th4   Joint Space #5 Joint Rotation Angle

;**************************************************************

;*****************DH Parameters==>Have to been Key in**********
Q1009=69.2        ;d1
Q1010=107.4       ;a1
Q1011=280       ;a2
Q1012=280       ;a3a
Q1013=82.5       ;a3
Q1014=140.00      ;d4
;**************************************************************

;*****************Inverse Kinermatic Equation******************
;Q1005= ATAN(Q1002/Q1001)  ;th1
;Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
;Q1024= 2*Q1011*Q1012
;Q1007= ACOS(Q1023/Q1024)   ;th3
;Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
;Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
;Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
;Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
;Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
;Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1022= Q1011+Q1012*COS(Q1007)
;Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)   ;th2
;Q1008= Q1004+Q1005   ;th4
;Q1007=Q1007+Q1006    ;Real th3 Command
;**************************************************************

;************ Start Of Cartesian Coordinate Position/Pose Point #1***************
Q1=471.686
Q2=-6
Q3=237.308
Q4=0
;************ End Of Cartesian Coordinate Position/Pose Point   #1***************

;************ Start Of Cartesian Coordinate Position/Pose Point #2***************
Q5=584.686
Q6=27
Q7=237
Q8=0
;************ End Of Cartesian Coordinate Position/Pose Point   #2***************

;************ Start Of Cartesian Coordinate Position/Pose Point #3***************
Q9=1584.686
Q10=27
Q11=221.308
Q12=0
;************ End Of Cartesian Coordinate Position/Pose Point   #3***************

;************ Start Of Cartesian Coordinate Position/Pose Point #4***************
Q13=1576.686
Q14=24
Q15=221.308
Q16=0
;************ End Of Cartesian Coordinate Position/Pose Point   #4***************

;************ Start Of Cartesian Coordinate Position/Pose Point #5***************
Q17=576.686
Q18=24
Q19=237.308
Q20=0
;************ End Of Cartesian Coordinate Position/Pose Point   #5***************

;************ Start Of Cartesian Coordinate Position/Pose Point #6***************
Q21=567.686
Q22=52
Q23=237.308
Q24=0
;************ End Of Cartesian Coordinate Position/Pose Point   #6***************
;************ Start Of Cartesian Coordinate Position/Pose Point #7***************
Q25=1567.686
Q26=52
Q27=221.308
Q28=0
;************ End Of Cartesian Coordinate Position/Pose Point   #7***************
;************ Start Of Cartesian Coordinate Position/Pose Point #8***************
Q29=1567.686
Q30=-4
Q31=221.308
Q32=0
;************ End Of Cartesian Coordinate Position/Pose Point   #8***************
;************ Start Of Cartesian Coordinate Position/Pose Point #9***************
Q33=1567.686
Q34=-4
Q35=237.308
Q36=0
;************ End Of Cartesian Coordinate Position/Pose Point   #9***************
;************ Start Of Cartesian Coordinate Position/Pose Point #10***************
Q37=1561.686
Q38=51
Q39=237.308
Q40=0
;************ End Of Cartesian Coordinate Position/Pose Point   #10***************
;************ Start Of Cartesian Coordinate Position/Pose Point #11***************
Q41=561.686
Q42=51
Q43=222.308
Q44=0
;************ End Of Cartesian Coordinate Position/Pose Point   #11***************
;************ Start Of Cartesian Coordinate Position/Pose Point #12***************
Q45=561.686
Q46=51
Q47=222.308
Q48=0
;************ End Of Cartesian Coordinate Position/Pose Point   #12***************
;************ Start Of Cartesian Coordinate Position/Pose Point #13***************
Q49=514.686
Q50=76
Q51=220.308
Q52=0
;************ End Of Cartesian Coordinate Position/Pose Point   #13***************
;************ Start Of Cartesian Coordinate Position/Pose Point #14***************
Q53=514.686
Q54=76
Q55=237.308
Q56=0
;************ End Of Cartesian Coordinate Position/Pose Point   #14***************
;************ Start Of Cartesian Coordinate Position/Pose Point #15***************
Q57=548.186
Q58=30.5
Q59=237.308
Q60=0
;************ End Of Cartesian Coordinate Position/Pose Point   #15***************
;************ Start Of Cartesian Coordinate Position/Pose Point #16***************
Q61=1548.186
Q62=30.5
Q63=220.308
Q64=0
;************ End Of Cartesian Coordinate Position/Pose Point   #16***************
;************ Start Of Cartesian Coordinate Position/Pose Point #17***************
Q65=1548.186
Q66=-4.5
Q67=220.308
Q68=0
;************ End Of Cartesian Coordinate Position/Pose Point   #17***************
;************ Start Of Cartesian Coordinate Position/Pose Point #18***************
Q69=548.186
Q70=-4.5
Q71=237.308
Q72=0
;************ End Of Cartesian Coordinate Position/Pose Point   #18***************
;************ Start Of Cartesian Coordinate Position/Pose Point #19***************
Q73=561.686
Q74=13.5
Q75=237.308
Q76=0
;************ End Of Cartesian Coordinate Position/Pose Point   #19***************
;************ Start Of Cartesian Coordinate Position/Pose Point #20***************
Q77=1561.686
Q78=13.5
Q79=220.308
Q80=0
;************ End Of Cartesian Coordinate Position/Pose Point   #20***************
;************ Start Of Cartesian Coordinate Position/Pose Point #20***************
Q81=1500.186
Q82=15.5
Q83=220.308
Q84=0
;************ End Of Cartesian Coordinate Position/Pose Point   #20***************
;************ Start Of Cartesian Coordinate Position/Pose Point #20***************
Q85=500.186
Q86=15.5
Q87=237.308
Q88=0
;************ End Of Cartesian Coordinate Position/Pose Point   #20***************
;************ Start Of Cartesian Coordinate Position/Pose Point #20***************
Q89=0
Q90=0
Q91=0
Q92=0
;************ End Of Cartesian Coordinate Position/Pose Point   #20***************

;以此類推
CMD"GAT"
N2
Q1005=0      ;th1=0
Q1006=0      ;th2=0
Q1007=0      ;th3=0
Q1008=0      ;th4=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
;**************************************************************
;**************************************************************
N1
Q1025=0
IF(Q(Q2041)<=-1000 OR Q(Q2041)>=1000)
    Q1025=1
    DWELL1
    GOTO5
ENDIF

Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDIF
Q1005= ATAN(Q1002/Q1001) 
Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024= 2*Q1011*Q1012
Q1007= ACOS(Q1023/Q1024)
Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022= Q1011+Q1012*COS(Q1007)
Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008= Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI

IF(P1023 > 40)
  CMD^A
  GOTO2
ELSE
  P1023 = P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI

;**************************************************************
;**************************************************************
;**************************************************************

N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Px
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Py
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))                   ;Pz
P1020=M462/M491-M162/M191                                                                           ;q4  Ref. To Base
I150=1
I186=100
I286=100
I386=100
I486=100
P994=10     ; Linear IK number
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000 AND Q(Q2041)<1000)
    Q1025=0
    DWELL1
    GOTO1
  ENDIF
ELSE
  DWELL1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDIF
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDIF
IF(P1=0)
  P1=0.01
ENDIF
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005= ATAN(P1018/P1017) 
  Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024= 2*Q1011*Q1012
  Q1007= ACOS(Q1023/Q1024)
  Q1020= Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018= P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022= Q1011+Q1012*COS(Q1007)
  Q1006= -ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008= P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4

IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
DWELL1
CMD"ENDG"
  CMD^A
GOTO2
CLOSE

OPEN PROG23 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog23 For Task3 27times is real executed*******************
P1023=0
ABS
Q1009=69.2
Q1010=107.4
Q1011=280
Q1012=280
Q1013=82.5
Q1014=140
Q1=620
Q2=150
Q3=75
Q4=0
Q5=620
Q6=150
Q7=60
Q8=0
Q9=620
Q10=150
Q11=75
Q12=0
Q13=1620
Q14=-150
Q15=75
Q16=0
Q17=620
Q18=-150
Q19=60
Q20=0
Q21=620
Q22=-150
Q23=75
Q24=0
Q25=1620
Q26=150
Q27=75
Q28=0
Q29=0
Q30=0
Q31=0
Q32=0
Q33=620
Q34=-150
Q35=88
Q36=0
Q37=320
Q38=-150
Q39=88
Q40=0
Q41=320
Q42=-150
Q43=63
Q44=0
Q45=320
Q46=-150
Q47=88
Q48=0
Q49=320
Q50=150
Q51=88
Q52=0
Q53=320
Q54=150
Q55=63
Q56=0
Q57=320
Q58=150
Q59=88
Q60=0
Q61=470
Q62=0
Q63=280
Q64=0
Q65=0
Q66=0
Q67=0
Q68=0
Q69=0
Q70=0
Q71=0
Q72=0
Q57=0
Q58=0
Q59=0
Q60=0
Q57=0
Q58=0
Q59=0
Q60=0
CMD"GAT"
N2
Q1005=0
Q1006=0
Q1007=0
Q1008=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
Q1035=0
Q1036=0
Q1037=0
Q1038=0
N1
F8000
TA250
Q1025=0
IF(Q(Q2041)<=-1000ORQ(Q2041)>=1000)
  Q1025=1
  GOTO5
ENDI
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDI
Q1005=ATAN(Q1002/Q1001)
Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024=2*Q1011*Q1012
Q1007=ACOS(Q1023/Q1024)
Q1020=Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018=Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022=Q1011+Q1012*COS(Q1007)
Q1006=-ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008=Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
Q1035=Q1005
Q1036=Q1006
Q1037=Q1007
Q1038=Q1008
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
IF(P1023>31)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))
P1020=M462/M491-M162/M191
I150=1
I186=100
I286=100
I386=100
I486=100
P994=20
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000ANDQ(Q2041)<1000)
    Q1025=0
    GOTO1
  ENDI
ELSE
  CMD"ENDG"
  CMD^A
  GOTO2
ENDI
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDI
IF(P1=0)
  P1=0.01
ENDI
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005=ATAN(P1018/P1017)
  Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024=2*Q1011*Q1012
  Q1007=ACOS(Q1023/Q1024)
  Q1020=Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018=P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022=Q1011+Q1012*COS(Q1007)
  Q1006=-ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008=P1020+Q1005
  Q1007=Q1007+Q1006
  Q1039=SQRT((Q1005-Q1035)*(Q1005-Q1035)+(Q1006-Q1036)*(Q1006-Q1036)+(Q1007-Q1037)*(Q1007-Q1037)+(Q1008-Q1038)*(Q1008-Q1038))
  Q1035=Q1005
  Q1036=Q1006
  Q1037=Q1007
  Q1038=Q1008
  Q1040=4
  Q1041=15000
  Q1044=25
  IF(P1036<Q1040)
    Q1046=0
    Q1042=Q1041/Q1040*P1036
    Q1043=Q1041/Q1040*(P1036+1)
    F(Q1043)
    TA(2*1.3*Q1039/(Q1042+Q1043)*60*1000)
  ELSE
    IF(P1036>=(P1037-Q1040))
      Q1046=0
      Q1042=Q1041-Q1041/Q1040*(P1036-(P1037-Q1040))
      Q1043=Q1041-Q1041/Q1040*(P1036-(P1037-Q1040)+1)
      IF(P1036>=(P1037-Q1040))
        F(Q1041/4*3.5)
        TA40
      ENDI
      IF(P1036>=(P1037-Q1040+1))
        F(Q1041/4*3)
        TA45
      ENDI
      IF(P1036>=(P1037-Q1040+2))
        F(Q1041/4*2)
        TA50
      ENDI
    ELSE
      IF(Q1046=0)
        Q1046=1
        F(Q1041)
        TA(Q1044)
      ENDI
    ENDI
  ENDI
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
IF(P1023>31)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI
CLOSE

OPEN PROG24 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog24 For Task3 56 times is real executed*******************
P1023=0
ABS
F17000
TA175
Q1009=69.2
Q1010=107.4
Q1011=280
Q1012=280
Q1013=82.5
Q1014=140
Q1=620
Q2=150
Q3=62
Q4=0
Q5=620
Q6=150
Q7=37
Q8=0
Q9=620
Q10=150
Q11=62
Q12=0
Q13=620
Q14=-150
Q15=62
Q16=0
Q17=620
Q18=-150
Q19=37
Q20=0
Q21=620
Q22=-150
Q23=62
Q24=0
Q25=620
Q26=150
Q27=62
Q28=0
Q29=0
Q30=0
Q31=0
CMD"GAT"
N2
Q1005=0
Q1006=0
Q1007=0
Q1008=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
N1
F17000
TA175
Q1025=0
IF(Q(Q2041)<=-1000ORQ(Q2041)>=1000)
  Q1025=1
  GOTO5
ENDI
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDI
Q1005=ATAN(Q1002/Q1001)
Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024=2*Q1011*Q1012
Q1007=ACOS(Q1023/Q1024)
Q1020=Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018=Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022=Q1011+Q1012*COS(Q1007)
Q1006=-ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008=Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
IF(P1023>310)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))
P1020=M462/M491-M162/M191I150=1
I186=100
I286=100I386=100
I486=100
P994=100
I105=0
I205=0
I305=0
I405=0
ABS
N4
IF(Q2041=13ORQ2041=25)
  F16000
  TA125
ENDI
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000ANDQ(Q2041)<1000)
    Q1025=0
    GOTO1
  ENDI
ELSE
  CMD"ENDG"
  CMD^A
  GOTO2
ENDI
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDI
IF(P1=0)
  P1=0.01
ENDI
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005=ATAN(P1018/P1017)
  Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024=2*Q1011*Q1012
  Q1007=ACOS(Q1023/Q1024)
  Q1020=Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018=P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022=Q1011+Q1012*COS(Q1007)
  Q1006=-ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008=P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWE2
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
IF(P1023>310)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI
CLOSE



OPEN PROG25 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog25 For Task 4 is real executed*******************
P1023=0
AROTX0
ABS
F7000
TA200
TS100
Q1009=69.2
Q1010=107.4
Q1011=280
Q1012=280
Q1013=82.5
Q1014=140
Q1=572
Q2=-198.1
Q3=64
Q4=0
Q5=1000+Q1
Q6=Q2
Q7=38.7
Q8=0
Q9=1000+Q1
Q10=Q2
Q11=91
Q12=0
Q13=Q1
Q14=288
Q15=15
Q16=0
Q17=1000+Q13
Q18=Q14
Q19=-17
Q20=0
Q21=1000+Q13
Q22=Q14
Q23=15
Q24=0
Q25=Q1-91
Q26=Q2
Q27=Q3
Q28=0
Q29=1000+Q25
Q30=Q26
Q31=Q7
Q32=0
Q33=1000+Q25
Q34=Q30
Q35=Q11
Q36=0
Q37=Q25
Q38=Q14+2
Q39=45
Q40=0
Q41=1000+Q37
Q42=Q38
Q43=Q19
Q44=0
Q45=1000+Q37
Q46=Q38
Q47=Q23
Q48=0
Q49=Q25-91
Q50=Q26
Q51=Q3
Q52=0
Q53=1000+Q49
Q54=Q50
Q55=Q7
Q56=0
Q57=1000+Q49
Q58=Q54
Q59=Q11
Q60=0
Q61=Q49
Q62=Q38+2
Q63=45
Q64=0
Q65=1000+Q61
Q66=Q62
Q67=Q19
Q68=0
Q69=1000+Q61
Q70=Q62
Q71=Q47
Q72=0
Q73=Q1
Q74=Q2-91
Q75=Q3
Q76=0
Q77=Q5
Q78=Q6-91
Q79=Q7
Q80=0
Q81=Q9
Q82=Q10-91
Q83=Q11
Q84=0
Q85=Q13
Q86=Q14-91
Q87=Q15
Q88=0
Q89=Q17
Q90=Q18-91
Q91=Q19
Q92=0
Q93=Q21
Q94=Q22-91
Q95=Q23
Q96=0
Q97=Q25
Q98=Q26-91
Q99=Q27
Q100=0
Q101=Q29
Q102=Q30-91
Q103=Q31
Q104=0
Q105=Q33
Q106=Q34-91
Q107=Q35
Q108=0
Q109=Q37
Q110=Q38-91
Q111=Q39
Q112=0
Q113=Q41
Q114=Q42-91
Q115=Q43
Q116=0
Q117=Q45
Q118=Q46-91
Q119=Q47
Q120=0
Q121=Q49
Q122=Q50-91
Q123=Q51
Q124=0
Q125=Q53
Q126=Q54-91
Q127=Q55
Q128=0
Q129=Q57
Q130=Q58-91
Q131=Q59
Q132=0
Q133=Q61
Q134=Q62-91
Q135=Q63
Q136=0
Q137=Q65
Q138=Q66-91
Q139=Q67
Q140=0
Q141=Q69
Q142=Q70-91
Q143=Q71
Q144=0
Q145=Q1
Q146=Q2
Q147=15+10
Q148=Q4
Q149=Q5
Q150=Q6
Q151=-17
Q152=Q8
Q153=Q9
Q154=Q10
Q155=38.5+45
Q156=Q12
Q157=Q13
Q158=Q14
Q159=91+55
Q160=Q16
Q161=Q17
Q162=Q18
Q163=38.7
Q164=Q20
Q165=Q21
Q166=Q22
Q167=64
Q168=Q24
Q169=Q25
Q170=Q26
Q171=Q147
Q172=Q28
Q173=Q29
Q174=Q30
Q175=Q151
Q176=Q32
Q177=Q33
Q178=Q34
Q179=Q155
Q180=Q36
Q181=Q37
Q182=Q38
Q183=Q159
Q184=Q40
Q185=Q41
Q186=Q42
Q187=Q163
Q188=Q44
Q189=Q45
Q190=Q46
Q191=Q167
Q192=Q48
Q193=Q49
Q194=Q50
Q195=Q147
Q196=Q52
Q197=Q53
Q198=Q54
Q199=Q151
Q200=Q56
Q201=Q57
Q202=Q58
Q203=Q155
Q204=Q60
Q205=Q61
Q206=Q62
Q207=Q159
Q208=Q64
Q209=Q65
Q210=Q66
Q211=Q163
Q212=Q68
Q213=Q69
Q214=Q70
Q215=Q167
Q216=Q72
Q217=Q73
Q218=Q74
Q219=Q147
Q220=Q76
Q221=Q77
Q222=Q78
Q223=Q151
Q224=Q80
Q225=Q81
Q226=Q82
Q227=Q155
Q228=Q84
Q229=Q85
Q230=Q86
Q231=Q159
Q232=Q88
Q233=Q89
Q234=Q90
Q235=Q163
Q236=Q92
Q237=Q93
Q238=Q94
Q239=Q167
Q240=Q96
Q241=Q97
Q242=Q98
Q243=Q147
Q244=Q100
Q245=Q101
Q246=Q102
Q247=Q151
Q248=Q104
Q249=Q105
Q250=Q106
Q251=Q155
Q252=Q108
Q253=Q109
Q254=Q110
Q255=Q159
Q256=Q112
Q257=Q113
Q258=Q114
Q259=Q163
Q260=Q116
Q261=Q117
Q262=Q118
Q263=Q167
Q264=Q120
Q265=Q121
Q266=Q122
Q267=Q147
Q268=Q124
Q269=Q125
Q270=Q126
Q271=Q151
Q272=Q128
Q273=Q129
Q274=Q130
Q275=Q155
Q276=Q132
Q277=Q133
Q278=Q134
Q279=Q159
Q280=Q136
Q281=Q137
Q282=Q138
Q283=Q163
Q284=Q140
Q285=Q141
Q286=Q142
Q287=Q167
Q288=Q144
Q289=0
Q290=0
Q291=0
Q292=0
CMD"GAT"
N2
Q1005=0
Q1006=0
Q1007=0
Q1008=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
N1
Q1025=0
IF(Q(Q2041)<=-1000ORQ(Q2041)>=1000)
  Q1025=1
  DWE1
  GOTO5
ENDI
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDI
Q1005=ATAN(Q1002/Q1001)
Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024=2*Q1011*Q1012
Q1007=ACOS(Q1023/Q1024)
Q1020=Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018=Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022=Q1011+Q1012*COS(Q1007)
Q1006=-ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008=Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWE1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
IF(P1023>13)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=1
  Q2042=2
  Q2043=3
  Q2044=4
  GOTO1
ENDI
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))
P1020=M462/M491-M162/M191
I150=1
I186=100
I286=100
I386=100
I486=100
P994=10
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000ANDQ(Q2041)<1000)
    Q1025=0
    DWE1
    GOTO1
  ENDI
ELSE
  DWE1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDI
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDI
IF(P1=0)
  P1=0.01
ENDI
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005=ATAN(P1018/P1017)
  Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024=2*Q1011*Q1012
  Q1007=ACOS(Q1023/Q1024)
  Q1020=Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018=P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022=Q1011+Q1012*COS(Q1007)
  Q1006=-ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008=P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWE1
IF(Q2041=5ORQ2041=29ORQ2041=53ORQ2041=77ORQ2041=101ORQ2041=125ORQ2041=149ORQ2041=173ORQ2041=197ORQ2041=221ORQ2041=245ORQ2041=269)
  DWE100
  M4=0
  DWE400
ENDI
IF(Q2041=17ORQ2041=41ORQ2041=65ORQ2041=89ORQ2041=113ORQ2041=137ORQ2041=161ORQ2041=185ORQ2041=209ORQ2041=233ORQ2041=257ORQ2041=281)
  DWE100
  M4=1
  DWE400
ENDI
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
DWE1
CMD"ENDG"
CMD^A
GOTO2
CLOSE

OPEN PROG30 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog30 For Task 1&2 is real executed*******************
P1023=0

ABS
F7000
TA200
TS100

;*********************Simulation Only Start; Take off this portion when real executed*******************
;************************Parameters Definition****************
;Q1001           ;Px    Cartesian Coordinate X Position  		Unit:mm  
;Q1002           ;Py    Cartesian Coordinate y Position  		Unit:mm  
;Q1003           ;Pz    Cartesian Coordinate z Position  		Unit:mm 
;Q1004           ;q4    Cartesian Coordinate #4 Axis Rotation Angle     Unit:Deg 
;Q1005           ;th1   Joint Space #1 Joint Rotation Angle
;Q1006           ;th2   Joint Space #2 Joint Rotation Angle 
;Q1007           ;th3   Joint Space #4 Joint Rotation Angle
;Q1008           ;th4   Joint Space #5 Joint Rotation Angle

;**************************************************************

;*****************DH Parameters==>Have to been Key in**********
Q1009=69.2        ;d1
Q1010=107.4       ;a1
Q1011=280       ;a2
Q1012=280       ;a3a
Q1013=82.5       ;a3
Q1014=140.00      ;d4
;**************************************************************

;*****************Inverse Kinermatic Equation******************
;Q1005= ATAN(Q1002/Q1001)  ;th1
;Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
;Q1024= 2*Q1011*Q1012
;Q1007= ACOS(Q1023/Q1024)   ;th3
;Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
;Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
;Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
;Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
;Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
;Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
;Q1022= Q1011+Q1012*COS(Q1007)
;Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)   ;th2
;Q1008= Q1004+Q1005   ;th4
;Q1007=Q1007+Q1006    ;Real th3 Command
;**************************************************************

;************ Start Of Cartesian Coordinate Position/Pose Point #1***************
Q1=620
Q2=150
Q3=90
Q4=0
Q5=1620
Q6=150
Q7=55
Q8=0
Q9=1620
Q10=150
Q11=90
Q12=0
Q13=1620
Q14=-150
Q15=90
Q16=0
Q17=1620
Q18=-150
Q19=55
Q20=0
Q21=1320
Q22=-150
Q23=55
Q24=0
Q25=1320
Q26=-150
Q27=90
Q28=0
Q29=1320
Q30=150
Q31=90
Q32=0
Q33=1320
Q34=150
Q35=55
Q36=0
Q37=1620
Q38=150
Q39=55
Q40=0
Q41=0
Q42=0
Q43=0
Q44=0
Q45=320
Q46=-150
Q47=90
Q48=0
Q49=320
Q50=150
Q51=90
Q52=0
Q53=320
Q54=150
Q55=60
Q56=0
Q57=320
Q58=150
Q59=90
Q60=0
Q61=470
Q62=0
Q63=90
Q64=0
Q65=0
Q66=0
Q67=0
Q68=0
Q69=0
Q70=0
Q71=0
Q72=0
Q73=0
Q74=0
Q75=0
Q76=0
;************ End Of Cartesian Coordinate Position/Pose Point   #19***************
;************ Start Of Cartesian Coordinate Position/Pose Point #20***************
Q77=0
Q78=0
Q79=0
Q80=0
;************ End Of Cartesian Coordinate Position/Pose Point   #20***************

;以此類推
CMD"GAT"
N2
Q1005=0      ;th1=0
Q1006=0      ;th2=0
Q1007=0      ;th3=0
Q1008=0      ;th4=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
;**************************************************************
;**************************************************************
N1
Q1025=0
IF(Q(Q2041)<=-1000 OR Q(Q2041)>=1000)
    Q1025=1
    DWELL1
    GOTO5
ENDIF

Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDIF
Q1005= ATAN(Q1002/Q1001) 
Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024= 2*Q1011*Q1012
Q1007= ACOS(Q1023/Q1024)
Q1020= Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018= Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022= Q1011+Q1012*COS(Q1007)
Q1006= -ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008= Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI

IF(P1023 > 13)
  CMD^A
  GOTO2
ELSE
  P1023 = P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI

;**************************************************************
;**************************************************************
;**************************************************************

N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Px
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))  ;Py
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))                   ;Pz
P1020=M462/M491-M162/M191                                                                           ;q4  Ref. To Base
I150=1
I186=100
I286=100
I386=100
I486=100
P994=10     ; Linear IK number
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000 AND Q(Q2041)<1000)
    Q1025=0
    DWELL1
    GOTO1
  ENDIF
ELSE
  DWELL1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDIF
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDIF
IF(P1=0)
  P1=0.01
ENDIF
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005= ATAN(P1018/P1017) 
  Q1023= Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024= 2*Q1011*Q1012
  Q1007= ACOS(Q1023/Q1024)
  Q1020= Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019= -Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015= Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017= Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026= 2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018= P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016= Q1012*1/COS(Q1005)*Sin(Q1007)*Sqrt(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021= 2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022= Q1011+Q1012*COS(Q1007)
  Q1006= -ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008= P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWELL1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4

IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
DWELL1
CMD"ENDG"
  CMD^A
GOTO2
CLOSE


OPEN PROG31 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog31 For Draw corss is real executed*******************

P1023=0
ABS
F7000
TA200
TS100
Q1009=69.2
Q1010=107.4
Q1011=280
Q1012=280
Q1013=82.5
Q1014=140
Q1=650
Q2=0
Q3=95
Q4=0
Q5=1650
Q6=0
Q7=80.28
Q8=0
Q9=1300
Q10=0
Q11=80.28
Q12=0
Q13=1300
Q14=0
Q15=95
Q16=0
Q17=0
Q18=-0
Q19=0
Q20=0
Q21=1620
Q22=-340
Q23=63.6
Q24=0
Q25=1620
Q26=340
Q27=63.6
Q28=0
Q29=1620
Q30=340
Q31=95
Q32=0
Q33=0
Q34=0
Q35=0
Q36=0
Q37=1470
Q38=150
Q39=63.1
Q40=0
Q41=1470
Q42=-150
Q43=63.1
Q44=0
Q45=1470
Q46=-150
Q47=75
Q48=0
Q49=620
Q50=-150
Q51=75
Q52=0
Q53=1620
Q54=-150
Q55=63.1
Q56=0
Q57=1620
Q58=150
Q59=63.1
Q60=0
Q61=1620
Q62=150
Q63=75
Q64=0
Q65=0
Q66=0
Q67=0
Q68=0
Q69=0
Q70=0
Q71=0
Q72=0
Q73=0
Q74=0
Q75=0
Q76=0
Q77=0
Q78=0
Q79=0
Q80=0
CMD"GAT"
N2
Q1005=0
Q1006=0
Q1007=0
Q1008=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
N1
Q1025=0
IF(Q(Q2041)<=-1000ORQ(Q2041)>=1000)
  Q1025=1
  DWE1
  GOTO5
ENDI
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDI
Q1005=ATAN(Q1002/Q1001)
Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024=2*Q1011*Q1012
Q1007=ACOS(Q1023/Q1024)
Q1020=Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018=Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022=Q1011+Q1012*COS(Q1007)
Q1006=-ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008=Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
DWE1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
IF(P1023>13)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=1
  Q2042=2
  Q2043=3
  Q2044=4
  GOTO1
ENDI
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))
P1020=M462/M491-M162/M191
I150=1
I186=100
I286=100
I386=100
I486=100
P994=5
I105=0
I205=0
I305=0
I405=0
ABS
N4
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000ANDQ(Q2041)<1000)
    Q1025=0
    DWE1
    GOTO1
  ENDI
ELSE
  DWE1
  CMD"ENDG"
  CMD^A
  GOTO2
ENDI
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDI
IF(P1=0)
  P1=0.01
ENDI
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005=ATAN(P1018/P1017)
  Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024=2*Q1011*Q1012
  Q1007=ACOS(Q1023/Q1024)
  Q1020=Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018=P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022=Q1011+Q1012*COS(Q1007)
  Q1006=-ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008=P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWE1
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
DWE1
IF(P1023>13)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=1
  Q2042=2
  Q2043=3
  Q2044=4
  GOTO5
ENDI
CLOSE


OPEN PROG32 CLEAR                 ;Q1025=0/1 Hybrid IK Moving
;*********************Simulation Only Start; Take off this portion when Prog32 For Draw corss is real executed*******************
;;;Task 3 , 33 times

P1023=0
ABS
F13000
TA165
Q1009=69.2
Q1010=107.4
Q1011=280
Q1012=280
Q1013=82.5
Q1014=140
Q1=620
Q2=150
Q3=75
Q4=0
Q5=620
Q6=150
Q7=60
Q8=0
Q9=620
Q10=150
Q11=75
Q12=0
Q13=1620
Q14=-150
Q15=75
Q16=0
Q17=620
Q18=-150
Q19=60
Q20=0
Q21=620
Q22=-150
Q23=75
Q24=0
Q25=1620
Q26=150
Q27=75
Q28=0
Q29=0
Q30=0
Q31=0
Q32=0
Q33=620
Q34=-150
Q35=88
Q36=0
Q37=320
Q38=-150
Q39=88
Q40=0
Q41=320
Q42=-150
Q43=63
Q44=0
Q45=320
Q46=-150
Q47=88
Q48=0
Q49=320
Q50=150
Q51=88
Q52=0
Q53=320
Q54=150
Q55=63
Q56=0
Q57=320
Q58=150
Q59=88
Q60=0
Q61=470
Q62=0
Q63=280
Q64=0
Q65=0
Q66=0
Q67=0
Q68=0
Q69=0
Q70=0
Q71=0
Q72=0
Q57=0
Q58=0
Q59=0
Q60=0
Q57=0
Q58=0
Q59=0
Q60=0
CMD"GAT"
N2
Q1005=0
Q1006=0
Q1007=0
Q1008=0
I150=1
I105=0
I205=0
I305=0
I405=0
ABS
Q2041=1
Q2042=2
Q2043=3
Q2044=4
P1017=0
P1018=0
P1019=0
P1020=0
I186=100
I286=100
I386=100
I486=100
P994=1
N1
F13000
TA165
Q1025=0
IF(Q(Q2041)<=-1000ORQ(Q2041)>=1000)
  Q1025=1
  GOTO5
ENDI
Q1001=Q(Q2041)
Q1002=Q(Q2042)
Q1003=Q(Q2043)
Q1004=Q(Q2044)
IF(Q1001=0)
  Q1001=0.01
ENDI
Q1005=ATAN(Q1002/Q1001)
Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*Q1003+2*Q1014*Q1003+Q1003*Q1003-2*(Q1010+Q1013)*Q1001*1/COS(Q1005)+Q1001*Q1001*1/COS(Q1005)*1/COS(Q1005)
Q1024=2*Q1011*Q1012
Q1007=ACOS(Q1023/Q1024)
Q1020=Q1012*Q1012*Q1001*SIN(Q1007)*SIN(Q1007)
Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
Q1018=Q1001*Q1001-2*Q1010*Q1001*COS(Q1005)-2*Q1013*Q1001*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*Q1001-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
Q1022=Q1011+Q1012*COS(Q1007)
Q1006=-ACOS((1/COS(Q1005)*(Q1001-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
Q1008=Q1004+Q1005
Q1007=Q1007+Q1006
LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO1
  ENDI
ENDI
IF(P1023>310)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI
N5
P1017=COS(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1018=SIN(M162/M191)*(Q1010+Q1013+Q1011*COS(M262/M291)+Q1012*COS(M262/M291+(M362/M391-M262/M291)))
P1019=Q1009-Q1014-Q1011*SIN(M262/M291)-Q1012*SIN(M262/M291+(M362/M391-M262/M291))
P1020=M462/M491-M162/M191
I150=1
I186=100
I286=100
I386=100
I486=100
P994=100
I105=0
I205=0
I305=0
I405=0
ABS
N4
IF(Q2041=13ORQ2041=25)
  F16000
  TA125
ENDI
Q1025=1
IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
  IF(Q(Q2041)>-1000ANDQ(Q2041)<1000)
    Q1025=0
    GOTO1
  ENDI
ELSE
  CMD"ENDG"
  CMD^A
  GOTO2
ENDI
IF(Q(Q2041)<=-1000)
  P1=Q(Q2041)+1000
ELSE
  P1=Q(Q2041)-1000
ENDI
IF(P1=0)
  P1=0.01
ENDI
P2=Q(Q2042)
P3=Q(Q2043)
P4=Q(Q2044)
P993=SQRT((P1-P1017)*(P1-P1017)+(P2-P1018)*(P2-P1018)+(P3-P1019)*(P3-P1019)+(P4-P1020)*(P4-P1020))
P1037=INT(P993/P994+0.5)
IF(P1037<=0)
  P1037=1
ENDI
P1036=0
P1038=(P1-P1017)/P1037
P1039=(P2-P1018)/P1037
P1040=(P3-P1019)/P1037
P1041=(P4-P1020)/P1037
N3
IF(P1036<P1037)
  P1017=P1017+P1038
  P1018=P1018+P1039
  P1019=P1019+P1040
  P1020=P1020+P1041
  Q1005=ATAN(P1018/P1017)
  Q1023=Q1010*Q1010-Q1011*Q1011+2*Q1010*Q1013+Q1013*Q1013-Q1012*Q1012+Q1009*Q1009-2*Q1009*Q1014+Q1014*Q1014-2*Q1009*P1019+2*Q1014*P1019+P1019*P1019-2*(Q1010+Q1013)*P1017*1/COS(Q1005)+P1017*P1017*1/COS(Q1005)*1/COS(Q1005)
  Q1024=2*Q1011*Q1012
  Q1007=ACOS(Q1023/Q1024)
  Q1020=Q1012*Q1012*P1017*SIN(Q1007)*SIN(Q1007)
  Q1019=-Q1013*COS(Q1005)-Q1020/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1015=Q1019+(Q1010*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1017=Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007)
  Q1026=2*Q1010*Q1013*COS(Q1005)*COS(Q1005)+Q1013*Q1013*COS(Q1005)*COS(Q1005)-2*Q1011*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)-Q1012*Q1012*COS(Q1005)*COS(Q1005)*COS(Q1007)*COS(Q1007)
  Q1018=P1017*P1017-2*Q1010*P1017*COS(Q1005)-2*Q1013*P1017*COS(Q1005)+Q1010*Q1010*COS(Q1005)*COS(Q1005)-Q1011*Q1011*COS(Q1005)*COS(Q1005)+Q1026
  Q1016=Q1012*1/COS(Q1005)*SIN(Q1007)*SQRT(Q1012*Q1012*COS(Q1005)*COS(Q1005)*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*(2*P1017-2*Q1010*COS(Q1005)-2*Q1013*COS(Q1005))*SIN(Q1007)*SIN(Q1007)-4*COS(Q1005)*COS(Q1005)*Q1018*Q1017)
  Q1021=2*(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))
  Q1022=Q1011+Q1012*COS(Q1007)
  Q1006=-ACOS((1/COS(Q1005)*(P1017-Q1010*COS(Q1005)+Q1015+(Q1013*Q1012*Q1012*COS(Q1005)*SIN(Q1007)*SIN(Q1007))/(Q1011*Q1011+2*Q1011*Q1012*COS(Q1007)+Q1012*Q1012*COS(Q1007)*COS(Q1007)+Q1012*Q1012*SIN(Q1007)*SIN(Q1007))-Q1016/Q1021))/Q1022)
  Q1008=P1020+Q1005
  Q1007=Q1007+Q1006
  LINX(Q1005)Y(Q1006)Z(Q1007)A(Q1008)
  P1036=P1036+1
  GOTO3
ENDI
DWE2
Q2041=Q2041+4
Q2042=Q2042+4
Q2043=Q2043+4
Q2044=Q2044+4
IF(Q2041<=2041)
  IF(Q(Q2041)!=0ORQ(Q2042)!=0ORQ(Q2043)!=0ORQ(Q2044)!=0)
    GOTO4
  ENDI
ENDI
IF(P1023>310)
  CMD^A
  GOTO2
ELSE
  P1023=P1023+1
  Q2041=5
  Q2042=6
  Q2043=7
  Q2044=8
  GOTO1
ENDI
CLOSE


ENAPLC1
ENAPLC8
ENAPLC10

M13->*
M14->*
M15->*
M16->*
M17->*
M18->*
M21->*
M22->*


;************************Simulation Setting Parameters**************
I20=$0F
I21=$01CD
I22=$01CE
I23=$01CF
I24=$01D0
I25=10
I26=40000
;I6=0
;I109=$540
;I209=$540
;I309=$540
;I409=$540
;I110=0
;I111=0
;I210=0
;I211=0
;I310=0
;I311=0
;I410=0
;I411=0
;I131=0
;I231=0
;I331=0
;I431=0
;I5=1
;M162->1cd,S         ; #1 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
;M262->1ce,S         ; #2 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
;M362->1cf,S         ; #3 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
;M462->1d0,S         ; #4 COMMAND POSITION (COUNTS) vvvvv ;1cd _CmdPos (800V)
;************************Simulation Setting Parameters**************




